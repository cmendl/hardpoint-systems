(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     96260,       2207]
NotebookOptionsPosition[     92451,       2073]
NotebookOutlinePosition[     92816,       2089]
CellTagsIndexPosition[     92773,       2086]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Anharmonic Chains", "Title",
 CellChangeTimes->{{3.59677987870557*^9, 3.596779889516188*^9}, {
  3.5967804634790173`*^9, 3.5967804758017216`*^9}, {3.5973486710445538`*^9, 
  3.5973486731016717`*^9}, {3.5973488033071194`*^9, 3.5973488074423556`*^9}}],

Cell["\<\
Reference: H. Spohn, Nonlinear fluctuating hydrodynamics for anharmonic \
chains. J. Stat. Phys. 154, 1191-1227 (2014)\
\>", "Text",
 CellChangeTimes->{{3.5966309106922355`*^9, 3.5966309448751907`*^9}, {
  3.61539048177046*^9, 3.61539050974306*^9}}],

Cell["Shoulder potential", "Text",
 CellChangeTimes->{{3.597348682436206*^9, 3.59734868566039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.597344823479486*^9, 3.5973448344961157`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<anharm_chains_altern_mass.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.5973460118404565`*^9, 3.597346033514696*^9}, {
  3.5976487301792974`*^9, 3.597648731720386*^9}, {3.5980369027916574`*^9, 
  3.5980369074419236`*^9}, {3.6154739554946623`*^9, 3.615473955899685*^9}}],

Cell[CellGroupData[{

Cell["Elastic collision", "Section",
 CellChangeTimes->{{3.5973487644628973`*^9, 3.5973487774776416`*^9}, {
  3.5973497655211544`*^9, 3.597349771645505*^9}, {3.598041543178073*^9, 
  3.5980415494444313`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], 
         SubscriptBox["u", "1"]}], "+", 
        RowBox[{
         SubscriptBox["m", "2"], 
         SubscriptBox["u", "2"]}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], 
         SubscriptBox["v", "1"]}], "+", 
        RowBox[{
         SubscriptBox["m", "2"], 
         SubscriptBox["v", "2"]}]}]}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "1"], 
         SuperscriptBox[
          SubscriptBox["u", "1"], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "2"], 
         SuperscriptBox[
          SubscriptBox["u", "2"], "2"]}]}], "\[Equal]", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "1"], 
         SuperscriptBox[
          SubscriptBox["v", "1"], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "2"], 
         SuperscriptBox[
          SubscriptBox["v", "2"], "2"]}]}]}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["v", "1"], ",", 
      SubscriptBox["v", "2"]}], "}"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.5980407937802095`*^9, 3.5980408664903684`*^9}, {
  3.5980409042965307`*^9, 3.598040907860735*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["v", "1"], "\[Rule]", 
      SubscriptBox["u", "1"]}], ",", 
     RowBox[{
      SubscriptBox["v", "2"], "\[Rule]", 
      SubscriptBox["u", "2"]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["v", "1"], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["m", "1"], "-", 
           SubscriptBox["m", "2"]}], ")"}], " ", 
         SubscriptBox["u", "1"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["u", "2"]}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]]}], ",", 
     RowBox[{
      SubscriptBox["v", "2"], "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["u", "1"]}], "-", 
           SubscriptBox["u", "2"]}], ")"}]}], "+", 
        RowBox[{
         SubscriptBox["m", "2"], " ", 
         SubscriptBox["u", "2"]}]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.598040856782813*^9, 3.5980408669263935`*^9}, 
   3.598040908269758*^9, 3.5980758972415943`*^9, 3.598077829051056*^9, 
   3.5980795300003448`*^9, 3.598080501113889*^9, {3.598080742786712*^9, 
   3.598080767871147*^9}, 3.5980848304549866`*^9, 3.598085333094736*^9, 
   3.598085421924817*^9, 3.5980855552854447`*^9, 3.5980867437634215`*^9, 
   3.598088700161321*^9, 3.5980888320988674`*^9, 3.598094218558735*^9, 
   3.598094796154772*^9, 3.598095003677641*^9, 3.6154739592768784`*^9, 
   3.6199322452331543`*^9, 3.6199387775847836`*^9, 3.6199389548929253`*^9, 
   3.6277308658262043`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["M", "mat"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{
         SubscriptBox["m", "1"], "-", 
         SubscriptBox["m", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"]}]], ",", 
       FractionBox[
        RowBox[{"2", 
         SubscriptBox["m", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"]}]]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", 
         SubscriptBox["m", "1"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"]}]], ",", 
       RowBox[{"-", 
        FractionBox[
         RowBox[{
          SubscriptBox["m", "1"], "-", 
          SubscriptBox["m", "2"]}], 
         RowBox[{
          SubscriptBox["m", "1"], "+", 
          SubscriptBox["m", "2"]}]]}]}], "}"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5980413670609994`*^9, 3.598041401093946*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["M", "mat"], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.598041436634979*^9, 3.598041437813046*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SubscriptBox["m", "1"], "-", 
        SubscriptBox["m", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        SubscriptBox["m", "2"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]]},
     {
      FractionBox[
       RowBox[{"2", " ", 
        SubscriptBox["m", "1"]}], 
       RowBox[{
        SubscriptBox["m", "1"], "+", 
        SubscriptBox["m", "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         SubscriptBox["m", "1"], "-", 
         SubscriptBox["m", "2"]}], 
        RowBox[{
         SubscriptBox["m", "1"], "+", 
         SubscriptBox["m", "2"]}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.598041438157066*^9, 3.598075897402603*^9, 3.5980778290940585`*^9, 
   3.5980795300463476`*^9, 3.5980805011528916`*^9, {3.5980807428307147`*^9, 
   3.5980807679161496`*^9}, 3.598084830498989*^9, 3.5980853331387386`*^9, 
   3.5980854219708195`*^9, 3.598085555332447*^9, 3.5980867438054237`*^9, 
   3.598088700204324*^9, 3.5980888321348696`*^9, 3.5980942186027374`*^9, 
   3.598094796215775*^9, 3.598095003706643*^9, 3.61547396122799*^9, 
   3.6199322452691565`*^9, 3.619938777614785*^9, 3.6199389549249268`*^9, 
   3.6277308676223073`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{"Eigenvalues", "[", 
   SubscriptBox["M", "mat"], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.598041441659266*^9, 3.598041472955056*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1"}], ",", "1"}], "}"}]], "Output",
 CellChangeTimes->{{3.5980414465765476`*^9, 3.598041473351079*^9}, 
   3.5980758974396057`*^9, 3.5980778291270604`*^9, 3.598079530077349*^9, 
   3.5980805011828933`*^9, {3.598080742865717*^9, 3.598080767958152*^9}, 
   3.5980823724539237`*^9, 3.5980848305399914`*^9, 3.5980853331697407`*^9, 
   3.5980854220088215`*^9, 3.5980855553714495`*^9, 3.598086743837426*^9, 
   3.5980887002373257`*^9, 3.598088832154871*^9, 3.598094218634739*^9, 
   3.598094796249777*^9, 3.598095003728644*^9, 3.6154739620900393`*^9, 
   3.6199322452911577`*^9, 3.619938777635786*^9, 3.619938954945928*^9, 
   3.6277308685023575`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], 
         SubscriptBox["u", "1"]}], "+", 
        RowBox[{
         SubscriptBox["m", "2"], 
         SubscriptBox["u", "2"]}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["m", "1"], 
         SubscriptBox["v", "1"]}], "+", 
        RowBox[{
         SubscriptBox["m", "2"], 
         SubscriptBox["v", "2"]}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "1"], 
         SuperscriptBox[
          SubscriptBox["u", "1"], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "2"], 
         SuperscriptBox[
          SubscriptBox["u", "2"], "2"]}]}], ")"}], "-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "1"], 
         SuperscriptBox[
          SubscriptBox["v", "1"], "2"]}], "+", 
        RowBox[{
         FractionBox["1", "2"], 
         SubscriptBox["m", "2"], 
         SuperscriptBox[
          SubscriptBox["v", "2"], "2"]}]}], ")"}]}]}], "}"}], "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SubscriptBox["v", "1"], "\[Rule]", 
      RowBox[{"First", "[", 
       RowBox[{
        SubscriptBox["M", "mat"], ".", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["u", "1"], ",", 
          SubscriptBox["u", "2"]}], "}"}]}], "]"}]}], ",", 
     RowBox[{
      SubscriptBox["v", "2"], "\[Rule]", 
      RowBox[{"Last", "[", 
       RowBox[{
        SubscriptBox["M", "mat"], ".", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["u", "1"], ",", 
          SubscriptBox["u", "2"]}], "}"}]}], "]"}]}]}], "}"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.598040987866311*^9, 3.598041066785825*^9}, {
  3.5980411159236355`*^9, 3.5980413607966413`*^9}, {3.598041399872876*^9, 
  3.5980414317877016`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0", ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.598041026475519*^9, {3.5980410573252835`*^9, 3.5980410670478396`*^9}, {
   3.5980411242901134`*^9, 3.5980412253288927`*^9}, {3.5980412742656918`*^9, 
   3.598041279102968*^9}, {3.5980413421325736`*^9, 3.5980413613236713`*^9}, {
   3.598041404978168*^9, 3.598041432559746*^9}, 3.598075897471607*^9, 
   3.5980778291600623`*^9, 3.5980795301143513`*^9, 3.598080501212895*^9, {
   3.598080742904719*^9, 3.598080767998154*^9}, 3.5980848305809937`*^9, 
   3.5980853332027426`*^9, 3.5980854220438237`*^9, 3.598085555413452*^9, 
   3.598086743872428*^9, 3.5980887002723274`*^9, 3.5980888324598885`*^9, 
   3.598094218669741*^9, 3.5980947962927794`*^9, 3.598095003751645*^9, 
   3.615473962818081*^9, 3.6199322453141594`*^9, 3.619938777660788*^9, 
   3.6199389549699297`*^9, 3.627730869430411*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"change", " ", "in", " ", "velocity"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"FullSimplify", "[", 
   RowBox[{
    RowBox[{
     SubscriptBox["M", "mat"], ".", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["u", "1"], ",", 
       SubscriptBox["u", "2"]}], "}"}]}], "-", 
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["u", "1"], ",", 
      SubscriptBox["u", "2"]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5980813964200983`*^9, 3.5980813987402306`*^9}, {
  3.598081649389567*^9, 3.5980816566899843`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     SubscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["u", "1"]}], "+", 
       SubscriptBox["u", "2"]}], ")"}]}], 
    RowBox[{
     SubscriptBox["m", "1"], "+", 
     SubscriptBox["m", "2"]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     SubscriptBox["m", "1"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", "1"], "-", 
       SubscriptBox["u", "2"]}], ")"}]}], 
    RowBox[{
     SubscriptBox["m", "1"], "+", 
     SubscriptBox["m", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.598081399066249*^9, {3.5980816576380386`*^9, 3.598081662916341*^9}, 
   3.5980848306359973`*^9, 3.5980853332587457`*^9, 3.598085422102827*^9, 
   3.5980855554694552`*^9, 3.5980867439264307`*^9, 3.598088700326331*^9, 
   3.598088832508891*^9, 3.5980942187417455`*^9, 3.5980947963457823`*^9, 
   3.598095003798648*^9, 3.615473963642128*^9, 3.619932245351161*^9, 
   3.6199387776967897`*^9, 3.6199389550069313`*^9, 3.6277308703214617`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "change", " ", "in", " ", "momentum", " ", "can", " ", "be", " ", 
    "expressed", " ", "in", " ", "terms", " ", "of", " ", "velocity", " ", 
    "difference"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"FullSimplify", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["m", "1"], ",", 
       SubscriptBox["m", "2"]}], "}"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SubscriptBox["M", "mat"], ".", 
        RowBox[{"{", 
         RowBox[{
          SubscriptBox["u", "1"], ",", 
          SubscriptBox["u", "2"]}], "}"}]}], "-", 
       RowBox[{"{", 
        RowBox[{
         SubscriptBox["u", "1"], ",", 
         SubscriptBox["u", "2"]}], "}"}]}], ")"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"check", " ", "momentum", " ", "conservation"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"FullSimplify", "[", 
    RowBox[{"Total", "[", "%", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.598041560417059*^9, 3.5980415674344597`*^9}, {
  3.5980416061326733`*^9, 3.598041695864806*^9}, {3.598073850742844*^9, 
  3.598073864200614*^9}, {3.5980803265849066`*^9, 3.59808033292727*^9}, {
  3.598080439659374*^9, 3.5980804436446023`*^9}, {3.598080509854389*^9, 
  3.5980805509757414`*^9}, {3.598082393965154*^9, 3.5980824083939795`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     SubscriptBox["m", "1"], " ", 
     SubscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        SubscriptBox["u", "1"]}], "+", 
       SubscriptBox["u", "2"]}], ")"}]}], 
    RowBox[{
     SubscriptBox["m", "1"], "+", 
     SubscriptBox["m", "2"]}]], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     SubscriptBox["m", "1"], " ", 
     SubscriptBox["m", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["u", "1"], "-", 
       SubscriptBox["u", "2"]}], ")"}]}], 
    RowBox[{
     SubscriptBox["m", "1"], "+", 
     SubscriptBox["m", "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.598041563846255*^9, 3.598041567821482*^9}, {
   3.5980416303680596`*^9, 3.5980416429757805`*^9}, {3.598041682951067*^9, 
   3.5980416970338726`*^9}, 3.598073872466087*^9, 3.5980758975286107`*^9, 
   3.5980778292210655`*^9, 3.598079530173355*^9, 3.5980803339043255`*^9, 
   3.598080444022624*^9, {3.598080501355903*^9, 3.5980805562390423`*^9}, {
   3.5980807430587273`*^9, 3.598080768194165*^9}, 3.5980824087439995`*^9, 
   3.5980848306819997`*^9, 3.5980853333077483`*^9, 3.598085422169831*^9, 
   3.598085555522458*^9, 3.598086743978434*^9, 3.5980887003773336`*^9, 
   3.5980888326208973`*^9, 3.598094218790748*^9, 3.5980947963957853`*^9, 
   3.5980950038366504`*^9, 3.6154739654632325`*^9, 3.619932245383163*^9, 
   3.619938777729792*^9, 3.6199389550389338`*^9, 3.6277308721195645`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.598041563846255*^9, 3.598041567821482*^9}, {
   3.5980416303680596`*^9, 3.5980416429757805`*^9}, {3.598041682951067*^9, 
   3.5980416970338726`*^9}, 3.598073872466087*^9, 3.5980758975286107`*^9, 
   3.5980778292210655`*^9, 3.598079530173355*^9, 3.5980803339043255`*^9, 
   3.598080444022624*^9, {3.598080501355903*^9, 3.5980805562390423`*^9}, {
   3.5980807430587273`*^9, 3.598080768194165*^9}, 3.5980824087439995`*^9, 
   3.5980848306819997`*^9, 3.5980853333077483`*^9, 3.598085422169831*^9, 
   3.598085555522458*^9, 3.598086743978434*^9, 3.5980887003773336`*^9, 
   3.5980888326208973`*^9, 3.598094218790748*^9, 3.5980947963957853`*^9, 
   3.5980950038366504`*^9, 3.6154739654632325`*^9, 3.619932245383163*^9, 
   3.619938777729792*^9, 3.6199389550389338`*^9, 3.6277308721205645`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Import initial data", "Section",
 CellChangeTimes->{{3.5973487644628973`*^9, 3.5973487774776416`*^9}, {
  3.5973497655211544`*^9, 3.597349771645505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"load", " ", "position", " ", "data", " ", "from", " ", "disk"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"data", ",", "0"}]], "=", 
    RowBox[{"Import", "[", 
     RowBox[{"\"\<collision_test_field_r0.dat\>\"", ",", "\"\<Real64\>\""}], 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "%", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5967815245657077`*^9, 3.5967815326961727`*^9}, {
   3.5967819770045853`*^9, 3.596782018703971*^9}, {3.5967821407389507`*^9, 
   3.5967821866975794`*^9}, {3.5967983494767103`*^9, 3.596798352068858*^9}, 
   3.597346466734475*^9, 3.5973469093667917`*^9, 3.598036913619277*^9, {
   3.598078139701824*^9, 3.598078141807945*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6368661693847875`", ",", "0.6816021219558586`", ",", 
   "0.5642095136595702`", ",", "1.970509435169439`", ",", 
   "2.5604186656219823`", ",", "0.6366153303083758`", ",", 
   "2.6429177332259663`", ",", "4.046116134183565`", ",", 
   "2.693705898954438`", ",", "1.8529520106179262`", ",", 
   "0.7004251782872878`", ",", "0.7832417416279274`", ",", 
   "1.8894386983436287`", ",", "2.0780129618270866`", ",", 
   "2.6143241788817053`", ",", "0.6227721168856394`"}], "}"}]], "Output",
 CellChangeTimes->{{3.596782153443678*^9, 3.596782159479023*^9}, 
   3.596782658083541*^9, 3.5967858210064497`*^9, 3.596786040736018*^9, 
   3.59678725289835*^9, {3.596798352518884*^9, 3.596798362296444*^9}, 
   3.5969129739279313`*^9, 3.5973460470834723`*^9, 3.5973464800892386`*^9, 
   3.5973466069114923`*^9, 3.5973469357012978`*^9, 3.5973488377810907`*^9, 
   3.597349938233033*^9, 3.597648737022689*^9, 3.5980759062651105`*^9, 
   3.598076612909528*^9, 3.598077829718094*^9, 3.5980781420299573`*^9, 
   3.598079530674383*^9, 3.5980805781702967`*^9, {3.598080743603759*^9, 
   3.598080768742197*^9}, 3.5980848311820283`*^9, 3.598085333910783*^9, 
   3.598085422833869*^9, 3.598085556023487*^9, 3.5980867444974637`*^9, 
   3.598088700872362*^9, 3.598088833751962*^9, 3.5980942193057775`*^9, 
   3.598094796914815*^9, 3.598095004404683*^9, 3.615473969456461*^9, 
   3.6154744968206244`*^9, 3.6199322500244284`*^9, {3.6199323173322783`*^9, 
   3.6199323462059298`*^9}, 3.6199387777747946`*^9, 3.6199389553349504`*^9, 
   3.6277308810120735`*^9}],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{{3.596782153443678*^9, 3.596782159479023*^9}, 
   3.596782658083541*^9, 3.5967858210064497`*^9, 3.596786040736018*^9, 
   3.59678725289835*^9, {3.596798352518884*^9, 3.596798362296444*^9}, 
   3.5969129739279313`*^9, 3.5973460470834723`*^9, 3.5973464800892386`*^9, 
   3.5973466069114923`*^9, 3.5973469357012978`*^9, 3.5973488377810907`*^9, 
   3.597349938233033*^9, 3.597648737022689*^9, 3.5980759062651105`*^9, 
   3.598076612909528*^9, 3.598077829718094*^9, 3.5980781420299573`*^9, 
   3.598079530674383*^9, 3.5980805781702967`*^9, {3.598080743603759*^9, 
   3.598080768742197*^9}, 3.5980848311820283`*^9, 3.598085333910783*^9, 
   3.598085422833869*^9, 3.598085556023487*^9, 3.5980867444974637`*^9, 
   3.598088700872362*^9, 3.598088833751962*^9, 3.5980942193057775`*^9, 
   3.598094796914815*^9, 3.598095004404683*^9, 3.615473969456461*^9, 
   3.6154744968206244`*^9, 3.6199322500244284`*^9, {3.6199323173322783`*^9, 
   3.6199323462059298`*^9}, 3.6199387777747946`*^9, 3.6199389553349504`*^9, 
   3.6277308810140734`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"average", " ", "elongation"}], ",", " ", 
    RowBox[{"should", " ", "be", " ", "conserved"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Mean", "[", 
   SubscriptBox["r", 
    RowBox[{"data", ",", "0"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967834993776608`*^9, 3.5967835166946507`*^9}, 
   3.5973469449668283`*^9, {3.5980766223890705`*^9, 3.5980766349247875`*^9}, {
   3.598077958621467*^9, 3.5980779623196783`*^9}}],

Cell[BoxData["1.6858829930584491`"], "Output",
 CellChangeTimes->{{3.596783502721852*^9, 3.5967835176437054`*^9}, 
   3.596785823577597*^9, 3.596786041341052*^9, 3.596787253024357*^9, 
   3.59679836293548*^9, 3.596912975046995*^9, 3.5973460483835464`*^9, 
   3.597346481881341*^9, 3.5973466080795593`*^9, {3.597346937634409*^9, 
   3.5973469462679024`*^9}, 3.5973488387851486`*^9, 3.5973499382570343`*^9, 
   3.5976487370416903`*^9, 3.5980759086772485`*^9, {3.59807661399259*^9, 
   3.598076636096854*^9}, 3.598077829752096*^9, 3.5980795307083855`*^9, 
   3.5980805799273973`*^9, {3.5980807437787685`*^9, 3.5980807688812046`*^9}, 
   3.5980848312190304`*^9, 3.5980853340647917`*^9, 3.5980854229528756`*^9, 
   3.598085556058489*^9, 3.598086744532466*^9, 3.5980887010213704`*^9, 
   3.598088833909971*^9, 3.5980942193417797`*^9, 3.598094797040822*^9, 
   3.598095004570692*^9, 3.6154739706895313`*^9, 3.615474498406715*^9, 
   3.619932251641521*^9, {3.6199323181403246`*^9, 3.619932346965973*^9}, 
   3.619938777799796*^9, 3.619938955359952*^9, 3.6277308819451265`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  SubscriptBox["q", 
   RowBox[{"data", ",", "0"}]], "=", 
  RowBox[{"Most", "[", 
   RowBox[{"Accumulate", "[", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], ",", "0"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.5967893805180426`*^9, 3.5967893899555826`*^9}, {
  3.5967895292355485`*^9, 3.596789530870642*^9}, {3.596789585013739*^9, 
  3.5967895863698163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0.6368661693847875`", ",", "1.318468291340646`", ",", 
   "1.8826778050002162`", ",", "3.853187240169655`", ",", 
   "6.413605905791638`", ",", "7.050221236100014`", ",", "9.69313896932598`", 
   ",", "13.739255103509546`", ",", "16.432961002463983`", ",", 
   "18.28591301308191`", ",", "18.986338191369196`", ",", 
   "19.769579932997125`", ",", "21.659018631340754`", ",", 
   "23.737031593167842`", ",", "26.351355772049548`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5967893857503414`*^9, 3.596789393010757*^9}, 
   3.596789531457676*^9, 3.596789586848844*^9, 3.59679836363052*^9, 
   3.596912975866042*^9, 3.5973460496216173`*^9, 3.597346484030464*^9, 
   3.5973466090126123`*^9, 3.597346948273017*^9, 3.5973488410632787`*^9, 
   3.597349938281036*^9, 3.5976487370626917`*^9, 3.5980759136285315`*^9, 
   3.598077829783098*^9, 3.598079530739387*^9, 3.598080581642495*^9, {
   3.598080743812771*^9, 3.5980807689102063`*^9}, 3.5980848313920403`*^9, 
   3.5980853341017933`*^9, 3.5980854229798775`*^9, 3.598085556194497*^9, 
   3.5980867447214766`*^9, 3.598088701060373*^9, 3.5980888339369726`*^9, 
   3.5980942194617863`*^9, 3.598094797087825*^9, 3.598095004667698*^9, 
   3.615473971602584*^9, 3.615474500017807*^9, 3.6199322533086166`*^9, {
   3.6199323190663776`*^9, 3.619932347574008*^9}, 3.6199387778227973`*^9, 
   3.619938955382953*^9, 3.6277308833592076`*^9}],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{{3.5967893857503414`*^9, 3.596789393010757*^9}, 
   3.596789531457676*^9, 3.596789586848844*^9, 3.59679836363052*^9, 
   3.596912975866042*^9, 3.5973460496216173`*^9, 3.597346484030464*^9, 
   3.5973466090126123`*^9, 3.597346948273017*^9, 3.5973488410632787`*^9, 
   3.597349938281036*^9, 3.5976487370626917`*^9, 3.5980759136285315`*^9, 
   3.598077829783098*^9, 3.598079530739387*^9, 3.598080581642495*^9, {
   3.598080743812771*^9, 3.5980807689102063`*^9}, 3.5980848313920403`*^9, 
   3.5980853341017933`*^9, 3.5980854229798775`*^9, 3.598085556194497*^9, 
   3.5980867447214766`*^9, 3.598088701060373*^9, 3.5980888339369726`*^9, 
   3.5980942194617863`*^9, 3.598094797087825*^9, 3.598095004667698*^9, 
   3.615473971602584*^9, 3.615474500017807*^9, 3.6199322533086166`*^9, {
   3.6199323190663776`*^9, 3.619932347574008*^9}, 3.6199387778227973`*^9, 
   3.619938955382953*^9, 3.6277308833612075`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"load", " ", "momentum", " ", "data", " ", "from", " ", "disk"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["p", 
    RowBox[{"data", ",", "0"}]], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<collision_test_field_p0.dat\>\"", ",", "\"\<Real64\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.596782172919791*^9, 3.596782194764041*^9}, {
   3.5967988456820917`*^9, 3.5967988462061214`*^9}, {3.597346489663786*^9, 
   3.5973464910828676`*^9}, 3.5973469569285126`*^9, 3.5980376323933887`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.6952593576618382`", ",", 
   RowBox[{"-", "1.4967107483252144`"}], ",", "0.4046930185164734`", ",", 
   RowBox[{"-", "1.0769024018096989`"}], ",", "0.6680851003113137`", ",", 
   RowBox[{"-", "2.8097800724988673`"}], ",", "0.3380523293122597`", ",", 
   RowBox[{"-", "0.01891824418911812`"}], ",", 
   RowBox[{"-", "0.30014818730034154`"}], ",", "2.7024515310382196`", ",", 
   RowBox[{"-", "1.268427282258284`"}], ",", "3.5614226915330693`", ",", 
   "0.4064222136173367`", ",", "1.5613931735611981`", ",", 
   RowBox[{"-", "1.1271373973726617`"}], ",", "2.3230983423738953`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.5967821769490223`*^9, 3.5967821985022545`*^9}, 
   3.5967826635918565`*^9, 3.5967835203648605`*^9, 3.596785824379643*^9, 
   3.596786041906085*^9, 3.5967872531663647`*^9, 3.5967895373590136`*^9, 
   3.5967895880929155`*^9, 3.59679884670815*^9, 3.596912977732149*^9, 
   3.596915581727089*^9, 3.597346054007868*^9, 3.597346492245934*^9, 
   3.5973466124148073`*^9, 3.5973469574985447`*^9, 3.5973488425693645`*^9, 
   3.59734993835404*^9, 3.5976487371166945`*^9, 3.598076644171316*^9, 
   3.5980778298491015`*^9, 3.598079530805391*^9, 3.5980805840886354`*^9, {
   3.598080743884775*^9, 3.5980807689932113`*^9}, 3.5980848314810457`*^9, 
   3.5980853341677976`*^9, 3.5980854230658817`*^9, 3.598085556272501*^9, 
   3.5980867447834797`*^9, 3.5980887011273766`*^9, 3.5980888340249777`*^9, 
   3.5980942195327907`*^9, 3.5980947971558285`*^9, 3.5980950047267013`*^9, 
   3.615473975023779*^9, 3.6199322555097423`*^9, {3.6199323201914415`*^9, 
   3.619932348215045*^9}, 3.6199387778667994`*^9, 3.6199389554289556`*^9, 
   3.62773088654739*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"expectation", " ", "value", " ", "is", " ", "zero"}], ",", " ", 
    RowBox[{
    "but", " ", "not", " ", "current", " ", "actual", " ", "value"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Mean", "[", 
   SubscriptBox["p", 
    RowBox[{"data", ",", "0"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967896123303013`*^9, 3.596789630357332*^9}, {
  3.597346974940542*^9, 3.5973469754545717`*^9}, {3.597347328353757*^9, 
  3.5973473532011776`*^9}, {3.598078008514321*^9, 3.598078011260478*^9}}],

Cell[BoxData["0.2851783390107136`"], "Output",
 CellChangeTimes->{{3.596789613634376*^9, 3.5967896308063583`*^9}, 
   3.5969129787592077`*^9, 3.596915582375126*^9, 3.5973460551139317`*^9, 
   3.5973464936750154`*^9, {3.5973469603927107`*^9, 3.5973469759456*^9}, 
   3.5973473546122584`*^9, 3.5973488437254305`*^9, 3.5973499383760414`*^9, 
   3.5976487371356955`*^9, 3.598076650645686*^9, 3.598077829961108*^9, 
   3.5980795309373984`*^9, 3.598080585953742*^9, {3.598080743919777*^9, 
   3.5980807690212126`*^9}, 3.598084831524048*^9, 3.5980853342017994`*^9, 
   3.5980854230878835`*^9, 3.598085556305503*^9, 3.5980867448074813`*^9, 
   3.5980887011603785`*^9, 3.5980888340489793`*^9, 3.5980942195647926`*^9, 
   3.5980947971868305`*^9, 3.5980950047497025`*^9, 3.615473975893829*^9, 
   3.619932257871877*^9, {3.6199323210624914`*^9, 3.619932348889083*^9}, 
   3.619938777889801*^9, 3.619938955452957*^9, 3.627730887713456*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"alternating", " ", "masses"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["m", 
     RowBox[{"0", ",", "1", ",", "val"}]], "=", 
    RowBox[{"{", 
     RowBox[{"1", ",", "3"}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.598078160130993*^9, 3.5980781719706697`*^9}, {
  3.5980804693770742`*^9, 3.598080478194578*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["mass", "val"], "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"ConstantArray", "[", 
    RowBox[{
     SubscriptBox["m", 
      RowBox[{"0", ",", "1", ",", "val"}]], ",", 
     RowBox[{
      RowBox[{"Length", "[", 
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], "]"}], "/", "2"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.598078117840574*^9, 3.5980781271721077`*^9}, {
   3.59807817633692*^9, 3.5980782044805293`*^9}, 3.5980804915103397`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "3", ",", "1", ",", "3", ",", "1", ",", "3", ",", "1", ",", "3", 
   ",", "1", ",", "3", ",", "1", ",", "3", ",", "1", ",", "3", ",", "1", ",", 
   "3"}], "}"}]], "Output",
 CellChangeTimes->{{3.598078123273885*^9, 3.5980781274941263`*^9}, {
   3.5980782054085827`*^9, 3.5980782106688833`*^9}, 3.598079530977401*^9, 
   3.5980805900319753`*^9, {3.5980807439597793`*^9, 3.5980807690502143`*^9}, 
   3.598084831575051*^9, 3.598085334238802*^9, 3.598085423116885*^9, 
   3.5980855563475056`*^9, 3.598086744836483*^9, 3.598088701199381*^9, 
   3.598088834077981*^9, 3.598094219603795*^9, 3.5980947972218323`*^9, 
   3.598095004776704*^9, 3.615473977503921*^9, 3.6199322622851295`*^9, {
   3.619932322675584*^9, 3.619932350145155*^9}, 3.6199387779168024`*^9, 
   3.619938955480959*^9, 3.627730889628566*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"hard", "-", 
    RowBox[{"core", " ", "potential", " ", "width"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["c", "val"], "=", 
    RowBox[{"1", "/", "2"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.596782481000413*^9, 3.59678250944304*^9}, {
  3.598076698575428*^9, 3.598076732821387*^9}, {3.5980767837152977`*^9, 
  3.5980767888495913`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VisualizeField", "[", 
  RowBox[{
   RowBox[{"Accumulate", "[", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], ",", "0.4"}], "]"}], "]"}], ",", 
   RowBox[{
    RowBox[{"Append", "[", 
     RowBox[{
      SubscriptBox["mass", "val"], ",", 
      RowBox[{"First", "[", 
       SubscriptBox["mass", "val"], "]"}]}], "]"}], "/", 
    RowBox[{"Mean", "[", 
     SubscriptBox["m", 
      RowBox[{"0", ",", "1", ",", "val"}]], "]"}]}], ",", 
   SubscriptBox["c", "val"], ",", "27"}], "]"}]], "Input",
 CellChangeTimes->{{3.5967825151643667`*^9, 3.5967825436219945`*^9}, {
   3.596783115201687*^9, 3.596783131740633*^9}, {3.5973488494877605`*^9, 
   3.5973488694549026`*^9}, 3.5980767980361166`*^9, {3.598077794884102*^9, 
   3.5980778194445066`*^9}, {3.598077867423251*^9, 3.598077878130863*^9}, {
   3.5980863294237227`*^9, 3.5980863377411985`*^9}, {3.5980867491867323`*^9, 
   3.598086751213848*^9}, {3.5980867927132215`*^9, 3.598086799544612*^9}, {
   3.598086905907696*^9, 3.5980869061127076`*^9}}],

Cell[BoxData[
 GraphicsBox[{{
    {RGBColor[0, 1, 0], DiskBox[{0.4, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{1.0368661693847874`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{1.718468291340646, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{2.2826778050002163`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{4.253187240169655, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{6.813605905791638, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{7.450221236100014, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{10.093138969325981`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{14.139255103509546`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{16.832961002463986`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{18.68591301308191, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{19.386338191369198`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{20.169579932997124`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{22.059018631340752`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{24.13703159316784, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 0, 1], 
     DiskBox[{26.751355772049546`, 0}, NCache[Rational[1, 4], 0.25]]}, 
    {RGBColor[0, 1, 0], 
     DiskBox[{27.374127888935185`, 0}, NCache[Rational[1, 4], 0.25]]}}, 
   {RGBColor[1, 0, 0], CircleBox[{0.4, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{1.0368661693847874`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{1.718468291340646, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{2.2826778050002163`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{4.253187240169655, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{6.813605905791638, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{7.450221236100014, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{10.093138969325981`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{14.139255103509546`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{16.832961002463986`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{18.68591301308191, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{19.386338191369198`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{20.169579932997124`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{22.059018631340752`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{24.13703159316784, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{26.751355772049546`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{27.374127888935185`, 0}, NCache[Rational[1, 4], 0.25]]}, 
   {GrayLevel[0.5], LineBox[{{0, 0}, {27, 0}}]}},
  ImageSize->Large,
  PlotRange->{{-1, 29}, All}]], "Output",
 CellChangeTimes->{
  3.5980777331305695`*^9, 3.5980778300681143`*^9, {3.5980778685133133`*^9, 
   3.5980778784188795`*^9}, 3.5980795310174026`*^9, 3.5980805953022766`*^9, {
   3.5980807439987817`*^9, 3.598080769081216*^9}, 3.5980848316280537`*^9, 
   3.598085334277804*^9, 3.5980854231578875`*^9, 3.598085556389508*^9, {
   3.598086331452839*^9, 3.598086341837433*^9}, {3.598086751796881*^9, 
   3.5980867659536905`*^9}, {3.5980867999586363`*^9, 3.598086825976124*^9}, 
   3.5980868581889668`*^9, 3.598086906418725*^9, 3.598086945855981*^9, 
   3.5980870718931894`*^9, 3.598087434319919*^9, 3.5980887012413836`*^9, 
   3.598088834111983*^9, 3.598094219648797*^9, 3.598094797769864*^9, 
   3.5980950048087063`*^9, 3.615473979668045*^9, 3.619932265389307*^9, {
   3.6199323242256727`*^9, 3.619932351438229*^9}, 3.619938777945804*^9, 
   3.6199389555149603`*^9, 3.6277308944478416`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "without", " ", "taking", " ", "collisions", " ", "into", " ", "account"}],
    " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"VisualizeField", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], "+", "0.4", "+", 
       RowBox[{"t", " ", 
        RowBox[{
         SubscriptBox["p", 
          RowBox[{"data", ",", "0"}]], "/", 
         SubscriptBox["mass", "val"]}]}]}], ",", 
      RowBox[{
       RowBox[{"Append", "[", 
        RowBox[{
         SubscriptBox["mass", "val"], ",", 
         RowBox[{"First", "[", 
          SubscriptBox["mass", "val"], "]"}]}], "]"}], "/", 
       RowBox[{"Mean", "[", 
        SubscriptBox["m", 
         RowBox[{"0", ",", "1", ",", "val"}]], "]"}]}], ",", 
      SubscriptBox["c", "val"], ",", "27"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967822229996557`*^9, 3.5967822286809807`*^9}, {
  3.596782266410139*^9, 3.5967823531551003`*^9}, {3.596782464601475*^9, 
  3.596782473984011*^9}, {3.59678270771338*^9, 3.5967828467173305`*^9}, {
  3.596782881907343*^9, 3.5967829128851147`*^9}, {3.596782996939923*^9, 
  3.5967830590674763`*^9}, {3.5967831682717223`*^9, 3.5967831897649517`*^9}, {
  3.596783373252446*^9, 3.596783390922457*^9}, {3.5967835297073956`*^9, 
  3.5967835331135902`*^9}, {3.5967894412025137`*^9, 3.596789484443987*^9}, {
  3.5967895442364063`*^9, 3.5967895944082766`*^9}, {3.5973488762202897`*^9, 
  3.597348876508306*^9}, {3.598078021232048*^9, 3.5980780238251963`*^9}, {
  3.5980782226495686`*^9, 3.598078222870581*^9}, {3.598079934777497*^9, 
  3.598079935516539*^9}, {3.598086916309291*^9, 3.5980869172003417`*^9}, {
  3.5980887505212016`*^9, 3.598088759510716*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 1.2750000000000001`, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 10}}, Typeset`size$$ = {576., {4., 8.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$4711$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$4711$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`VisualizeField[
       Subscript[$CellContext`q, $CellContext`data, 0] + 
        0.4 + $CellContext`t$$ (
          Subscript[$CellContext`p, $CellContext`data, 0]/
          Subscript[$CellContext`mass, $CellContext`val]), Append[
          Subscript[$CellContext`mass, $CellContext`val], 
          First[
           Subscript[$CellContext`mass, $CellContext`val]]]/Mean[
         Subscript[$CellContext`m, 0, 1, $CellContext`val]], 
        Subscript[$CellContext`c, $CellContext`val], 27], 
      "Specifications" :> {{$CellContext`t$$, 0, 10, AnimationRunning -> 
         False, AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {41., 48.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.5967833800148335`*^9, 3.596783402302108*^9}, 
   3.5967835334846115`*^9, 3.596783579122222*^9, 3.5967837091226573`*^9, 
   3.596787253242369*^9, {3.5967894713442373`*^9, 3.5967894852250314`*^9}, 
   3.596789547298582*^9, 3.596789595385332*^9, {3.596794658426922*^9, 
   3.5967946727097387`*^9}, 3.597346062505354*^9, {3.5973488731831155`*^9, 
   3.5973488775083632`*^9}, 3.597349938454046*^9, 3.5976487372026997`*^9, 
   3.5980778301401186`*^9, 3.598078024957261*^9, 3.5980782238406367`*^9, 
   3.598079531051405*^9, 3.598079936099572*^9, {3.5980807440327835`*^9, 
   3.598080769135219*^9}, 3.5980848316710567`*^9, 3.598085334316806*^9, 
   3.5980854232198906`*^9, 3.59808555642651*^9, 3.5980868613621483`*^9, 
   3.59808691804639*^9, 3.5980887012843857`*^9, 3.598088760086749*^9, 
   3.598088834165986*^9, 3.5980942196827993`*^9, 3.598094797842868*^9, 
   3.5980950048657093`*^9, 3.619932274980856*^9, {3.6199323288499374`*^9, 
   3.6199323521962724`*^9}, 3.6199389555439625`*^9, 3.6277308976990275`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run simulation", "Section",
 CellChangeTimes->{{3.5973487644628973`*^9, 3.5973487673450623`*^9}, {
  3.5973497829601517`*^9, 3.597349785121276*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NextCollision", "[", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"data", ",", "0"}]], ",", 
    SubscriptBox["p", 
     RowBox[{"data", ",", "0"}]], ",", 
    SubscriptBox["mass", "val"], ",", 
    SubscriptBox["c", "val"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967854220366306`*^9, 3.5967854638080196`*^9}, {
   3.5967855063464527`*^9, 3.5967855065524645`*^9}, {3.5967855530041213`*^9, 
   3.5967855623036532`*^9}, {3.596787026235385*^9, 3.596787044739444*^9}, {
   3.596787892574937*^9, 3.596787896550164*^9}, {3.5969147075420885`*^9, 
   3.5969147101372366`*^9}, {3.5980782719963913`*^9, 3.598078297795867*^9}, 
   3.598079550706529*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "1.1454907286795595`"}], ",", "0.08408123093268466`", ",", 
   "3"}], "}"}]], "Output",
 CellChangeTimes->{
  3.596785510285678*^9, {3.596785548471862*^9, 3.5967855729632626`*^9}, {
   3.596785626428321*^9, 3.596785636924921*^9}, {3.596785675940153*^9, 
   3.596785692393094*^9}, {3.5967857430479913`*^9, 3.5967857645912232`*^9}, {
   3.5967858071266565`*^9, 3.5967858311710315`*^9}, {3.5967860156775846`*^9, 
   3.5967860487894783`*^9}, 3.5967860849965496`*^9, 3.596786130482151*^9, 
   3.596787045442484*^9, 3.596787253322374*^9, 3.5967878974222145`*^9, 
   3.5967896751108923`*^9, 3.596913913574676*^9, 3.596914314069583*^9, 
   3.596914710700269*^9, 3.596915636131201*^9, 3.596915843358053*^9, 
   3.597346069620761*^9, 3.5973465044486322`*^9, 3.597348911602313*^9, 
   3.597349938577053*^9, 3.597648737241702*^9, {3.5980782794158154`*^9, 
   3.5980782985289087`*^9}, 3.5980795515755787`*^9, 3.598079810243374*^9, 
   3.5980806204537153`*^9, {3.5980807440857863`*^9, 3.598080769193222*^9}, 
   3.5980848317420607`*^9, {3.59808533439081*^9, 3.5980853580791655`*^9}, 
   3.598085423244892*^9, 3.598085556479513*^9, 3.598087496468474*^9, 
   3.598088701340389*^9, 3.598088774528575*^9, 3.598088834212989*^9, 
   3.5980942197378025`*^9, 3.5980947983588977`*^9, 3.5980950049107113`*^9, 
   3.615473990368657*^9, 3.619932354863425*^9, 3.6199387977239356`*^9, 
   3.619938955727973*^9, 3.6277309071505685`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"UpdateField", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox["q", 
         RowBox[{"data", ",", "0"}]], ",", 
        SubscriptBox["p", 
         RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
      RowBox[{"Total", "[", 
       SubscriptBox["r", 
        RowBox[{"data", ",", "0"}]], "]"}], ",", 
      SubscriptBox["mass", "val"], ",", 
      SubscriptBox["c", "val"]}], "]"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Differences", "[", 
    RowBox[{"First", "[", "%", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5967883007112813`*^9, 3.5967883196773663`*^9}, {
   3.596788399616938*^9, 3.5967884279695597`*^9}, {3.59678893814074*^9, 
   3.596788944115082*^9}, {3.5967892892898245`*^9, 3.596789294847142*^9}, 
   3.596789368987383*^9, {3.5967896997032986`*^9, 3.5967897028944817`*^9}, {
   3.5967924655864983`*^9, 3.5967924693947163`*^9}, 3.598080020368392*^9, 
   3.5980807160261817`*^9, 3.5980848564164715`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.5364594794186579`", ",", "0.7575776364590419`", ",", "0.5`", ",", 
   "2.0568652792842412`", ",", "2.425495325638077`", ",", 
   "0.7437891086585564`", ",", "2.6139636541715614`", ",", 
   "4.0214095282193085`", ",", "2.7946845450934017`", ",", 
   "1.6705592662885103`", ",", "0.9068923734533954`", ",", 
   "0.717597953702029`", ",", "1.8990275050119365`", ",", 
   "1.9394805753580933`", ",", "2.7742049347512214`"}], "}"}]], "Output",
 CellChangeTimes->{{3.596788428437587*^9, 3.5967884386511707`*^9}, 
   3.5967887181091547`*^9, 3.5967887607175922`*^9, {3.5967888267623696`*^9, 
   3.59678885387292*^9}, {3.596788940639883*^9, 3.596788944450101*^9}, 
   3.596789295642188*^9, {3.5967896813752503`*^9, 3.5967897036445246`*^9}, 
   3.596789895630505*^9, 3.596789954313862*^9, 3.5967923972675905`*^9, {
   3.5967924592361355`*^9, 3.596792469662731*^9}, 3.596913918066933*^9, 
   3.5969143158816867`*^9, 3.5969156772695537`*^9, 3.596915845010148*^9, 
   3.5973460744000344`*^9, 3.597346509620928*^9, 3.597348919180747*^9, 
   3.5973499386250553`*^9, 3.5976487372827044`*^9, {3.5980807192173643`*^9, 
   3.5980807692472258`*^9}, 3.598084571707187*^9, {3.598084831807064*^9, 
   3.598084857125512*^9}, 3.598085334452814*^9, 3.5980854281231713`*^9, 
   3.598085567041117*^9, 3.5980874971225114`*^9, 3.5980887013723907`*^9, 
   3.598088775364623*^9, 3.5980888342339897`*^9, 3.598094219769804*^9, 
   3.598094798851926*^9, 3.598095004931713*^9, 3.6154739917617364`*^9, 
   3.6199323688412247`*^9, 3.6199387977609377`*^9, 3.6199389557529745`*^9, 
   3.627730908541648*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["f", "seq"], "=", 
   RowBox[{"FieldSequence", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
     RowBox[{"Total", "[", 
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], "]"}], ",", 
     SubscriptBox["mass", "val"], ",", 
     SubscriptBox["c", "val"], ",", "42"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.5973490830671206`*^9, 3.5973491350730953`*^9}, {
   3.597349573947197*^9, 3.597349577512401*^9}, 3.597349651063608*^9, 
   3.5980800213664494`*^9, 3.5980845787075877`*^9, 3.5980848212214584`*^9, {
   3.5980856992776804`*^9, 3.59808572112293*^9}, {3.5980859380353365`*^9, 
   3.598085942375585*^9}, {3.598088272996889*^9, 3.5980882990333776`*^9}, {
   3.5980944325819764`*^9, 3.5980944326479797`*^9}, {3.5980949607821875`*^9, 
   3.598094961973256*^9}, 3.6199388671939087`*^9}],

Cell[BoxData["43"], "Output",
 CellChangeTimes->{
  3.5973495776744103`*^9, 3.59734965145163*^9, 3.597349938668058*^9, 
   3.5976487373187065`*^9, {3.5980845748023643`*^9, 3.598084578982603*^9}, 
   3.5980848319080696`*^9, 3.5980849425553985`*^9, 3.59808561936911*^9, {
   3.598085700946776*^9, 3.5980857220649843`*^9}, {3.598085913247919*^9, 
   3.5980859426816025`*^9}, 3.5980874979095564`*^9, {3.5980882737509317`*^9, 
   3.5980882995074053`*^9}, 3.5980887014193935`*^9, 3.5980887797598743`*^9, 
   3.598088834272992*^9, 3.598094219815807*^9, 3.598094433105006*^9, 
   3.598094798911929*^9, 3.5980949628173037`*^9, 3.5980950049727154`*^9, 
   3.6154739928617997`*^9, 3.6199323701703005`*^9, 3.61993879779994*^9, 
   3.619938867474925*^9, 3.6199389558739815`*^9, 3.6277309095517054`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["f", "seq"], "\[LeftDoubleBracket]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.5967932520064793`*^9, 3.59679326076398*^9}, {
   3.5969139536539683`*^9, 3.5969139590232754`*^9}, 3.596914004326867*^9, {
   3.59734610998407*^9, 3.59734611506536*^9}, {3.597348931457449*^9, 
   3.5973489316374593`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0.6368661693847875`", ",", "1.318468291340646`", ",", 
       "1.8826778050002162`", ",", "3.853187240169655`", ",", 
       "6.413605905791638`", ",", "7.050221236100014`", ",", 
       "9.69313896932598`", ",", "13.739255103509546`", ",", 
       "16.432961002463983`", ",", "18.28591301308191`", ",", 
       "18.986338191369196`", ",", "19.769579932997125`", ",", 
       "21.659018631340754`", ",", "23.737031593167842`", ",", 
       "26.351355772049548`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.6952593576618382`", ",", 
       RowBox[{"-", "1.4967107483252144`"}], ",", "0.4046930185164734`", ",", 
       RowBox[{"-", "1.0769024018096989`"}], ",", "0.6680851003113137`", ",", 
       RowBox[{"-", "2.8097800724988673`"}], ",", "0.3380523293122597`", ",", 
       RowBox[{"-", "0.01891824418911812`"}], ",", 
       RowBox[{"-", "0.30014818730034154`"}], ",", "2.7024515310382196`", ",", 
       RowBox[{"-", "1.268427282258284`"}], ",", "3.5614226915330693`", ",", 
       "0.4064222136173367`", ",", "1.5613931735611981`", ",", 
       RowBox[{"-", "1.1271373973726617`"}], ",", "2.3230983423738953`"}], 
      "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.05845826260967512`", ",", "0.5949177420283328`", ",", 
       "1.352495378487375`", ",", "1.852495378487375`", ",", 
       "3.9093606577716167`", ",", "6.334855983409693`", ",", 
       "7.07864509206825`", ",", "9.692608746239811`", ",", 
       "13.71401827445912`", ",", "16.50870281955252`", ",", 
       "18.179262085841035`", ",", "19.08615445929443`", ",", 
       "19.803752412996456`", ",", "21.702779918008392`", ",", 
       "23.642260493366486`", ",", "26.416465428117707`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.6952593576618382`", ",", 
       RowBox[{"-", "1.4967107483252144`"}], ",", 
       RowBox[{"-", "0.740797710163086`"}], ",", "0.0685883268698606`", ",", 
       "0.6680851003113137`", ",", 
       RowBox[{"-", "2.8097800724988673`"}], ",", "0.3380523293122597`", ",", 
       RowBox[{"-", "0.01891824418911812`"}], ",", 
       RowBox[{"-", "0.30014818730034154`"}], ",", "2.7024515310382196`", ",", 
       RowBox[{"-", "1.268427282258284`"}], ",", "3.5614226915330693`", ",", 
       "0.4064222136173367`", ",", "1.5613931735611981`", ",", 
       RowBox[{"-", "1.1271373973726617`"}], ",", "2.3230983423738953`"}], 
      "}"}], ",", "0.08408123093268481`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.1812481444854546`", ",", "0.8287624306376309`", ",", 
       "1.3287624306376309`", ",", "2.469993972314121`", ",", 
       "4.617701234999138`", ",", "7.850906662241012`", ",", 
       "8.752170299632276`", ",", "9.661390543427082`", ",", 
       "12.228137202514816`", ",", "15.764191868132551`", ",", 
       "17.103922309016422`", ",", "22.148379620345853`", ",", 
       "22.808393538842385`", ",", "23.591277753398945`", ",", 
       "24.89937432440219`", ",", "26.009714491047173`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.1124281941409215`", ",", 
       RowBox[{"-", "1.482347816897207`"}], ",", 
       RowBox[{"-", "0.02826378855312539`"}], ",", "3.632348420170075`", ",", 
       "0.7243741567240964`", ",", "3.070500981406505`", ",", 
       "0.3380523293122597`", ",", 
       RowBox[{"-", "0.01891824418911812`"}], ",", 
       RowBox[{"-", "0.30014818730034154`"}], ",", 
       RowBox[{"-", "2.26763211748104`"}], ",", "0.38826726724813576`", ",", 
       RowBox[{"-", "1.8262936295397028`"}], ",", "0.35161743311754545`", ",",
        "1.024340159663942`", ",", 
       RowBox[{"-", "1.7012549050899999`"}], ",", "1.5457831714384724`"}], 
      "}"}], ",", "5.034572804141715`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.596793252284495*^9, 3.5967932611950045`*^9}, 
   3.5967947041505365`*^9, 3.5969139262253995`*^9, 3.596913959711315*^9, 
   3.596914004511877*^9, 3.5969143237441363`*^9, 3.59691585449269*^9, 
   3.5969171371330533`*^9, 3.597346081194423*^9, 3.5973461157103972`*^9, 
   3.5973465143071957`*^9, {3.597348927821241*^9, 3.597348932148488*^9}, {
   3.5973491127588186`*^9, 3.5973491370912104`*^9}, 3.5973496551788435`*^9, 
   3.597349938691059*^9, 3.5976487373377075`*^9, 3.598084866859069*^9, 
   3.5980849492337804`*^9, 3.5980856228213077`*^9, {3.5980859326880307`*^9, 
   3.598085944261693*^9}, {3.598087491470188*^9, 3.598087498613597*^9}, {
   3.598088274706987*^9, 3.5980883020975533`*^9}, 3.598088701455395*^9, 
   3.5980887807219296`*^9, 3.5980888342949934`*^9, 3.598094219850809*^9, 
   3.5980944347380996`*^9, 3.598094798940931*^9, 3.5980949642983885`*^9, 
   3.598095004997717*^9, 3.6154739978470845`*^9, 3.619932374427544*^9, 
   3.619938801605158*^9, 3.619938868288972*^9, 3.619938955900983*^9, 
   3.627730915204029*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Interpolation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Last", "[", "#", "]"}], ",", 
       RowBox[{"First", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    SubscriptBox["f", "seq"]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VisualizeField", "[", 
    RowBox[{
     RowBox[{"%", "[", "t", "]"}], ",", 
     RowBox[{
      SubscriptBox["mass", "val"], "/", 
      RowBox[{"Mean", "[", 
       SubscriptBox["m", 
        RowBox[{"0", ",", "1", ",", "val"}]], "]"}]}], ",", 
     SubscriptBox["c", "val"], ",", "27"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "3.5"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5967902258253913`*^9, 3.596790243615409*^9}, {
   3.5967929736985607`*^9, 3.596793015417947*^9}, {3.5967931032839727`*^9, 
   3.5967931211919966`*^9}, {3.596793152111765*^9, 3.596793174019018*^9}, {
   3.5967932161084256`*^9, 3.5967932227328043`*^9}, 3.59679327387673*^9, {
   3.596800106512207*^9, 3.5968001117875085`*^9}, 3.5973462614357324`*^9, {
   3.597348939956935*^9, 3.5973489544927664`*^9}, {3.597349145074667*^9, 
   3.5973491451756725`*^9}, 3.598080022532516*^9, {3.598086311136677*^9, 
   3.5980863166019897`*^9}, 3.5980863540521317`*^9, {3.59808747436121*^9, 
   3.598087481923642*^9}, 3.5980883067988224`*^9, {3.598094452566119*^9, 
   3.598094453712185*^9}, {3.598094969294675*^9, 3.598094971009773*^9}}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["InterpolatingFunction", "SummaryHead"], 
       "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "5.034572804141715`"}], "}"}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output dimensions: \"", "SummaryItemAnnotation"],
                    "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "16", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "5.034572804141715`"}], "}"}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output dimensions: \"", "SummaryItemAnnotation"],
                    "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "16", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Order: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"Hermite\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Periodic: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["False", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("InterpolatingFunction[{{0., 5.03457}}, <>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.596790244582464*^9, 3.59679038997478*^9, 3.5967924125354643`*^9, 
   3.5967926629387865`*^9, {3.5967929967938814`*^9, 3.5967930157159643`*^9}, 
   3.596793122870093*^9, {3.5967931534238405`*^9, 3.5967931745640497`*^9}, {
   3.5967932191466*^9, 3.5967932232438335`*^9}, 3.596793275240808*^9, 
   3.596794705362606*^9, 3.596913931897724*^9, 3.597346084540614*^9, 
   3.597346262605799*^9, {3.59734894091899*^9, 3.5973489548517866`*^9}, 
   3.5973491463787413`*^9, 3.5973496653954277`*^9, 3.5973499387150607`*^9, 
   3.5976487373587084`*^9, 3.5980856308937693`*^9, 3.5980859478598986`*^9, {
   3.598086312610761*^9, 3.598086317628048*^9}, 3.5980863545461597`*^9, {
   3.5980874829927034`*^9, 3.5980875008347235`*^9}, 3.598088275741046*^9, 
   3.5980883073478537`*^9, 3.598088701488397*^9, 3.5980887837141*^9, 
   3.5980888343179946`*^9, 3.5980942198898115`*^9, {3.5980944425695477`*^9, 
   3.59809445415421*^9}, 3.598094798975933*^9, 3.598094971540803*^9, 
   3.598095005020718*^9, 3.6154740011172714`*^9, 3.61993237663567*^9, 
   3.619938803614272*^9, 3.6199388690260134`*^9, 3.619938955924984*^9, 
   3.627730916714115*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 1.8138035297393797`, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 3.5}}, Typeset`size$$ = {576., {4., 8.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$4853$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$4853$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`VisualizeField[
        InterpolatingFunction[{{0., 5.034572804141715}}, {
         4, 3, 0, {43}, {2}, 0, 0, 0, 0, Automatic, {}, {}, 
          False}, CompressedData["
1:eJwBaQGW/iFib1JlAgAAAAEAAAArAAAAAAAAAAAAAAC/NBD5WIa1P7yUYwxB
V70/MjYDqbZzxj/3jouMBjjMP/Kv1nPDY9Q/K8o3ZA041z8CK1JUZPnXP5fC
JXdYHts/8OhbRzuj4z/WV5kiVPXjP4RyVcb/pe4/bmxUu6c78D9IypIdS4v0
P7+R/kNdJfY/pKP+Ee9l/D/r/GewR0v+P9zJcxZyVP4/RsSdVEaOAkCPmn5e
mS4DQBGzAGJ0WwVApPUsY4VpBUBlCDJznbYFQHKE2Yu86AlA9lnij/sHCkCd
bbm6cS0KQLL602COmwtAa5HQmSwsDEB12JB/CVAPQKsWx6hn6w9AZamBKaop
EEAqByYZgF8QQDxaWa2LuBBAU0hjytkzEUAzaCf+fOgRQI+1cG78BxJAhLdl
RC1HEkAI6NRu448SQFI5XV0QrRJAUkWt4o7QEkCnPsoKbwkTQLM77/bJeBNA
jXqcDWcjFECo75bc
         "], CompressedData["
1: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
         "], {Automatic}][$CellContext`t$$], 
        Subscript[$CellContext`mass, $CellContext`val]/Mean[
         Subscript[$CellContext`m, 0, 1, $CellContext`val]], 
        Subscript[$CellContext`c, $CellContext`val], 27], 
      "Specifications" :> {{$CellContext`t$$, 0, 3.5, AnimationRunning -> 
         False, AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {41., 48.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.596790244582464*^9, 3.59679038997478*^9, 3.5967924125354643`*^9, 
   3.5967926629387865`*^9, {3.5967929967938814`*^9, 3.5967930157159643`*^9}, 
   3.596793122870093*^9, {3.5967931534238405`*^9, 3.5967931745640497`*^9}, {
   3.5967932191466*^9, 3.5967932232438335`*^9}, 3.596793275240808*^9, 
   3.596794705362606*^9, 3.596913931897724*^9, 3.597346084540614*^9, 
   3.597346262605799*^9, {3.59734894091899*^9, 3.5973489548517866`*^9}, 
   3.5973491463787413`*^9, 3.5973496653954277`*^9, 3.5973499387150607`*^9, 
   3.5976487373587084`*^9, 3.5980856308937693`*^9, 3.5980859478598986`*^9, {
   3.598086312610761*^9, 3.598086317628048*^9}, 3.5980863545461597`*^9, {
   3.5980874829927034`*^9, 3.5980875008347235`*^9}, 3.598088275741046*^9, 
   3.5980883073478537`*^9, 3.598088701488397*^9, 3.5980887837141*^9, 
   3.5980888343179946`*^9, 3.5980942198898115`*^9, {3.5980944425695477`*^9, 
   3.59809445415421*^9}, 3.598094798975933*^9, 3.598094971540803*^9, 
   3.598095005020718*^9, 3.6154740011172714`*^9, 3.61993237663567*^9, 
   3.619938803614272*^9, 3.6199388690260134`*^9, 3.619938955924984*^9, 
   3.627730916785119*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare with C implementation", "Section",
 CellChangeTimes->{{3.5973492095113525`*^9, 3.597349212176505*^9}, {
  3.597349243104274*^9, 3.597349246965495*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"CollisionInfo", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"q_List", ",", "p_List", ",", "t_"}], "}"}], ",", "L_", ",", 
    "mass_", ",", "VdCore_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"r", "=", 
       RowBox[{"FieldDifferences", "[", 
        RowBox[{"q", ",", "L"}], "]"}]}], ",", "\[CapitalDelta]t", ",", "i"}],
      "}"}], ",", "\n", "\t", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"\[CapitalDelta]t", ",", "i"}], "}"}], "=", 
      RowBox[{"Rest", "[", 
       RowBox[{"NextCollision", "[", 
        RowBox[{"r", ",", "p", ",", "mass", ",", "VdCore"}], "]"}], "]"}]}], 
     ";", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"t", "+", "\[CapitalDelta]t"}], ",", "i"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.5980855140060835`*^9, 3.598085515362161*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "reference", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["coll", "ref"], "=", 
    RowBox[{
     RowBox[{
      RowBox[{"CollisionInfo", "[", 
       RowBox[{
        RowBox[{"AdvanceField", "[", 
         RowBox[{"#", ",", 
          SubscriptBox["mass", "val"], ",", "0.0001"}], "]"}], ",", 
        RowBox[{"Total", "[", 
         SubscriptBox["r", 
          RowBox[{"data", ",", "0"}]], "]"}], ",", 
        SubscriptBox["mass", "val"], ",", 
        SubscriptBox["c", "val"]}], "]"}], "&"}], "/@", 
     SubscriptBox["f", "seq"]}]}], "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "%", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.59764415023734*^9, 3.597644249868039*^9}, {
   3.5976444252400694`*^9, 3.597644425564088*^9}, {3.5976487904367447`*^9, 
   3.597648798004177*^9}, 3.5980800270857763`*^9, {3.5980884119068336`*^9, 
   3.598088448831946*^9}, 3.598094273057852*^9, 3.598094361328901*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.08408123093268481`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11461264183488401`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.17540629627767285`", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.22045976507717288`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3185890799747987`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.3627961615267476`", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.37459667429418186`", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4237271464872178`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6136757272463722`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6236973453294421`", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9577635644632925`", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.01456425834365`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.284007182618227`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.384122148135347`", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.7748861983220445`", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.8933789149157814`", ",", "11"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.8956166150134015`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.319470082344682`", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.3977534658800503`", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.6696555763686622`", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.676523947534138`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.714167499508266`", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.23864087350426`", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.2538977852775544`", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.272189577850169`", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.4509551586810057`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.521569444348804`", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.914080616576991`", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"3.9899438081509593`", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.040688179530069`", ",", "14"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.09326209349255`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.180220326021807`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.300635492620205`", ",", "10"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.477039309649672`", ",", "16"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.5077988868992085`", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.569508618076615`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.64051602529981`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.669007738890587`", ",", "13"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.7036700647598355`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.759212654680289`", ",", "15"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4.867957933761249`", ",", "12"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.034572804141715`", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.126393677974119`", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.5976441001764765`*^9, 3.5976441531755085`*^9, 3.5976442290408473`*^9, 
   3.597644439462883*^9, 3.5976469047918916`*^9, {3.597648785849482*^9, 
   3.597648798366198*^9}, 3.5980884194312644`*^9, 3.598088450908065*^9, 
   3.5980887017334113`*^9, {3.5980888145258627`*^9, 3.5980888345630083`*^9}, {
   3.5980942754239874`*^9, 3.598094284315496*^9}, 3.598094361849931*^9, 
   3.598094467749988*^9, 3.5980948009540462`*^9, {3.5980949838905096`*^9, 
   3.598095005125724*^9}, 3.6154740150520687`*^9, 3.615474095582675*^9, 
   3.6154744882751355`*^9, 3.61993881650101*^9, 3.61993887176017*^9, 
   3.6199389559829874`*^9, 3.627730949192973*^9}],

Cell[BoxData["43"], "Output",
 CellChangeTimes->{
  3.5976441001764765`*^9, 3.5976441531755085`*^9, 3.5976442290408473`*^9, 
   3.597644439462883*^9, 3.5976469047918916`*^9, {3.597648785849482*^9, 
   3.597648798366198*^9}, 3.5980884194312644`*^9, 3.598088450908065*^9, 
   3.5980887017334113`*^9, {3.5980888145258627`*^9, 3.5980888345630083`*^9}, {
   3.5980942754239874`*^9, 3.598094284315496*^9}, 3.598094361849931*^9, 
   3.598094467749988*^9, 3.5980948009540462`*^9, {3.5980949838905096`*^9, 
   3.598095005125724*^9}, 3.6154740150520687`*^9, 3.615474095582675*^9, 
   3.6154744882751355`*^9, 3.61993881650101*^9, 3.61993887176017*^9, 
   3.6199389559829874`*^9, 3.627730949193973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "load", " ", "C", " ", "implementation", " ", "results", " ", "from", " ", 
    "disk"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\"\<collision_test_event_\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     SubscriptBox["coll", "test"], "=", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"(*", " ", 
        RowBox[{"event", " ", "times"}], " ", "*)"}], 
       RowBox[{
        RowBox[{"Import", "[", 
         RowBox[{
          RowBox[{"%", "<>", "\"\<time.dat\>\""}], ",", "\"\<Real64\>\""}], 
         "]"}], ",", 
        RowBox[{"(*", " ", 
         RowBox[{"particle", " ", "indices"}], " ", "*)"}], 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{
           RowBox[{"%", "<>", "\"\<iprt.dat\>\""}], ",", 
           "\"\<Integer32\>\""}], "]"}], "+", "1"}]}], "}"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "%", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5969140773820457`*^9, 3.596914080047198*^9}, {
   3.596914150474226*^9, 3.5969141549094796`*^9}, {3.596914341738166*^9, 
   3.596914446926182*^9}, {3.596914532286064*^9, 3.5969145551853743`*^9}, {
   3.5969146278525305`*^9, 3.5969146303196716`*^9}, {3.597346522123643*^9, 
   3.597346523279709*^9}, {3.5973489668894753`*^9, 3.5973489989713106`*^9}, 
   3.5973495963614793`*^9, 3.5980376355885715`*^9, {3.598088251465657*^9, 
   3.5980882568739667`*^9}, {3.59809429557914*^9, 3.5980943053036966`*^9}}],

Cell[BoxData["43"], "Output",
 CellChangeTimes->{
  3.5969140816732907`*^9, 3.596914330081499*^9, {3.5969143668816037`*^9, 
   3.596914375709109*^9}, {3.596914410765114*^9, 3.5969144475992203`*^9}, {
   3.5969145361372848`*^9, 3.5969145559664187`*^9}, 3.5969146316627483`*^9, 
   3.5969158586789293`*^9, 3.596916904795764*^9, 3.5969171299736433`*^9, 
   3.596917159996361*^9, 3.597346089038872*^9, 3.5973462856361165`*^9, 
   3.5973465269419184`*^9, {3.597348973349845*^9, 3.597348999242326*^9}, 
   3.5973491570703535`*^9, 3.597349598067577*^9, 3.597349679669244*^9, {
   3.597349852206113*^9, 3.5973498674969873`*^9}, 3.597349938896071*^9, 
   3.5976487376227236`*^9, {3.598088238805933*^9, 3.598088259464115*^9}, 
   3.598088325320882*^9, 3.5980887016204047`*^9, 3.598088801873139*^9, 
   3.598088834469003*^9, 3.5980942200398197`*^9, 3.59809430973895*^9, 
   3.5980943759687386`*^9, 3.598094470258131*^9, 3.5980948053082952`*^9, {
   3.598094918743783*^9, 3.598094955699897*^9}, {3.598094986138638*^9, 
   3.5980950052297297`*^9}, 3.6154740162551374`*^9, 3.6154740964837265`*^9, 
   3.615474488334139*^9, {3.619938819409176*^9, 3.619938873612276*^9}, 
   3.619938956050991*^9, 3.6277309528481817`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["coll", "test"], "\[LeftDoubleBracket]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.597349604229929*^9, 3.597349623683042*^9}, {
  3.6277309613776703`*^9, 3.6277309654399023`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.08408123093268464`", ",", "3"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.11461264183488402`", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5.126393677974141`", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.597349610067263*^9, 3.5973496809453173`*^9, {3.5973498536611958`*^9, 
   3.597349867942013*^9}, 3.5973499389170723`*^9, 3.597648737644725*^9, 
   3.5980882637953625`*^9, 3.598088326573953*^9, 3.5980887016514063`*^9, 
   3.598088802838194*^9, 3.5980888344920044`*^9, 3.5980943130331383`*^9, 
   3.5980943774898252`*^9, 3.598094472129238*^9, 3.598094805469304*^9, {
   3.598094987293704*^9, 3.5980950052527313`*^9}, 3.6154740186722755`*^9, 
   3.615474097234769*^9, 3.61547448834814*^9, 3.6199388757763996`*^9, 
   3.6199389560759926`*^9, {3.6277309575134487`*^9, 3.627730969215118*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "compare", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Norm", "[", 
   RowBox[{
    SubscriptBox["coll", "ref"], "-", 
    SubscriptBox["coll", "test"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5969146763713055`*^9, 3.59691468921104*^9}, {
   3.5969148489101744`*^9, 3.5969148528664007`*^9}, {3.5969149597155123`*^9, 
   3.5969149995127883`*^9}, {3.5969150311295967`*^9, 3.596915050456702*^9}, {
   3.5969165222298827`*^9, 3.5969165525946198`*^9}, {3.596916628065936*^9, 
   3.5969166664481316`*^9}, {3.5969168917110157`*^9, 
   3.5969168923230505`*^9}, {3.5973490029055357`*^9, 
   3.5973490119100504`*^9}, {3.597349165489835*^9, 3.5973491692400494`*^9}, 
   3.5973497377055635`*^9, 3.598080026015715*^9, {3.598088333597355*^9, 
   3.5980884029373207`*^9}, {3.5980884342851143`*^9, 
   3.5980884393824053`*^9}, {3.598094346575057*^9, 3.5980943534614506`*^9}, {
   3.598094392235669*^9, 3.598094392480683*^9}, 3.5980944839919167`*^9}],

Cell[BoxData["8.11386117346478`*^-14"], "Output",
 CellChangeTimes->{
  3.5969146901540937`*^9, {3.596915007952271*^9, 3.5969150508007216`*^9}, 
   3.596916553115649*^9, {3.5969166291809998`*^9, 3.5969166668021517`*^9}, {
   3.5969168927590756`*^9, 3.5969169056018105`*^9}, {3.5969171263914385`*^9, 
   3.5969171426933713`*^9}, 3.597346092974097*^9, 3.5973462864231615`*^9, 
   3.5973465302261066`*^9, 3.59734901225007*^9, 3.5973491700780973`*^9, 
   3.5973496835454655`*^9, 3.5973497384726076`*^9, {3.5973498545912495`*^9, 
   3.597349868657054*^9}, 3.597349938957074*^9, 3.5976487376837273`*^9, {
   3.598088370780482*^9, 3.5980884032393384`*^9}, 3.5980884398354316`*^9, 
   3.598088701691409*^9, 3.5980888038462515`*^9, 3.598088834521006*^9, 
   3.598094356349616*^9, 3.5980943931747227`*^9, {3.5980944743013625`*^9, 
   3.5980944848489656`*^9}, 3.5980948055043063`*^9, {3.5980949887197857`*^9, 
   3.5980950052797327`*^9}, 3.615474019671333*^9, {3.6154740915594444`*^9, 
   3.61547409794681*^9}, 3.6154744883621407`*^9, 3.6199388773974924`*^9, 
   3.619938956097994*^9, 3.6277309706171985`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "save", " ", "reference", " ", "to", " ", "disk", " ", "for", " ", 
    "comparison"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\"\<collision_test_ref_event_\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", " ", 
      RowBox[{"event", " ", "times"}], " ", "*)"}], 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"%", "<>", "\"\<time.dat\>\""}], ",", 
        RowBox[{
         SubscriptBox["coll", "ref"], "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        "\"\<Real64\>\""}], "]"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"particle", " ", "indices"}], " ", "*)"}], 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"%", "<>", "\"\<iprt.dat\>\""}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["coll", "ref"], "\[LeftDoubleBracket]", 
          RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}], "-", "1"}], 
        ",", "\"\<Integer32\>\""}], "]"}]}], "}"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5976442729843607`*^9, 3.5976444480583744`*^9}, {
   3.5976467120228662`*^9, 3.5976467257726526`*^9}, 3.597648805427602*^9, {
   3.5976490113943825`*^9, 3.5976490251551695`*^9}, 3.5980376380197105`*^9, {
   3.5980884608006306`*^9, 3.5980884615886755`*^9}, 3.598088500094878*^9, {
   3.598094506561208*^9, 3.598094507687272*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1067, 677},
WindowMargins->{{Automatic, 404}, {198, Automatic}},
ShowSelection->True,
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 255, 3, 90, "Title"],
Cell[838, 27, 259, 5, 30, "Text"],
Cell[1100, 34, 99, 1, 30, "Text"],
Cell[1202, 37, 191, 4, 31, "Input"],
Cell[1396, 43, 317, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[1738, 52, 208, 3, 63, "Section"],
Cell[CellGroupData[{
Cell[1971, 59, 1492, 49, 46, "Input"],
Cell[3466, 110, 1916, 54, 48, "Output"]
}, Open  ]],
Cell[5397, 167, 1082, 37, 48, "Input"],
Cell[CellGroupData[{
Cell[6504, 208, 149, 3, 31, "Input"],
Cell[6656, 213, 1892, 53, 84, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8585, 271, 194, 4, 31, "Input"],
Cell[8782, 277, 702, 12, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9521, 294, 2089, 70, 74, "Input"],
Cell[11613, 366, 886, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12536, 385, 598, 18, 52, "Input"],
Cell[13137, 405, 1086, 30, 48, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14260, 440, 1397, 36, 92, "Input"],
Cell[15660, 478, 1505, 36, 48, "Output"],
Cell[17168, 516, 838, 11, 31, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18055, 533, 159, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[18239, 539, 791, 17, 72, "Input"],
Cell[19033, 558, 1576, 25, 52, "Output"],
Cell[20612, 585, 1076, 15, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21725, 605, 505, 12, 52, "Input"],
Cell[22233, 619, 1068, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[23338, 638, 524, 14, 52, "Input"],
Cell[23865, 654, 1424, 22, 52, "Output"],
Cell[25292, 678, 950, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26279, 696, 584, 13, 52, "Input"],
Cell[26866, 711, 1699, 26, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28602, 742, 575, 13, 52, "Input"],
Cell[29180, 757, 926, 12, 31, "Output"]
}, Open  ]],
Cell[30121, 772, 415, 11, 52, "Input"],
Cell[CellGroupData[{
Cell[30561, 787, 509, 14, 31, "Input"],
Cell[31073, 803, 854, 14, 31, "Output"]
}, Open  ]],
Cell[31942, 820, 442, 12, 52, "Input"],
Cell[CellGroupData[{
Cell[32409, 836, 1078, 24, 31, "Input"],
Cell[33490, 862, 3858, 67, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37385, 934, 1921, 42, 72, "Input"],
Cell[39309, 978, 3327, 60, 106, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[42685, 1044, 154, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[42864, 1050, 755, 16, 52, "Input"],
Cell[43622, 1068, 1463, 23, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45122, 1096, 1091, 25, 72, "Input"],
Cell[46216, 1123, 1612, 25, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47865, 1153, 1083, 25, 52, "Input"],
Cell[48951, 1180, 789, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49777, 1196, 523, 11, 52, "Input"],
Cell[50303, 1209, 4935, 89, 192, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55275, 1303, 1590, 35, 52, "Input"],
Cell[56868, 1340, 10079, 198, 81, "Output"],
Cell[66950, 1540, 10890, 185, 106, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[77889, 1731, 165, 2, 63, "Section"],
Cell[78057, 1735, 909, 27, 72, "Input"],
Cell[CellGroupData[{
Cell[78991, 1766, 982, 23, 72, "Input"],
Cell[79976, 1791, 4027, 98, 132, "Output"],
Cell[84006, 1891, 690, 10, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[84733, 1906, 1535, 35, 112, "Input"],
Cell[86271, 1943, 1205, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87513, 1965, 403, 9, 52, "Input"],
Cell[87919, 1976, 895, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88851, 1998, 985, 17, 52, "Input"],
Cell[89839, 2017, 1098, 15, 31, "Output"]
}, Open  ]],
Cell[90952, 2035, 1471, 34, 92, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
