(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     59037,       1370]
NotebookOptionsPosition[     56134,       1266]
NotebookOutlinePosition[     56478,       1281]
CellTagsIndexPosition[     56435,       1278]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Anharmonic Chains", "Title",
 CellChangeTimes->{{3.59677987870557*^9, 3.596779889516188*^9}, {
  3.5967804634790173`*^9, 3.5967804758017216`*^9}}],

Cell["\<\
Reference: H. Spohn, Nonlinear fluctuating hydrodynamics for anharmonic \
chains. J. Stat. Phys. 154, 1191-1227 (2014)\
\>", "Text",
 CellChangeTimes->{{3.5966309106922355`*^9, 3.5966309448751907`*^9}, {
  3.61539048177046*^9, 3.61539050974306*^9}}],

Cell["Shoulder potential", "Text",
 CellChangeTimes->{{3.597348682436206*^9, 3.59734868566039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.597344823479486*^9, 3.5973448344961157`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<anharm_chains_shoulder.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.5973460118404565`*^9, 3.597346033514696*^9}, {
  3.597643948809819*^9, 3.59764394970187*^9}, {3.6149484199900455`*^9, 
  3.614948420575079*^9}}],

Cell[CellGroupData[{

Cell["Import initial data", "Section",
 CellChangeTimes->{{3.5973487644628973`*^9, 3.5973487774776416`*^9}, {
  3.5973497655211544`*^9, 3.597349771645505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"load", " ", "position", " ", "data", " ", "from", " ", "disk"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["r", 
    RowBox[{"data", ",", "0"}]], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<collision_test_field_r0.dat\>\"", ",", "\"\<Real64\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5967815245657077`*^9, 3.5967815326961727`*^9}, {
   3.5967819770045853`*^9, 3.596782018703971*^9}, {3.5967821407389507`*^9, 
   3.5967821866975794`*^9}, {3.5967983494767103`*^9, 3.596798352068858*^9}, 
   3.597346466734475*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.9305516898626545`", ",", "1.893969510909061`", ",", "2.062713998395131`",
    ",", "1.8509679216063888`", ",", "1.8648593598569538`", ",", 
   "0.9119842938220205`", ",", "1.6695139605830986`", ",", 
   "0.8154392649646909`"}], "}"}]], "Output",
 CellChangeTimes->{{3.596782153443678*^9, 3.596782159479023*^9}, 
   3.596782658083541*^9, 3.5967858210064497`*^9, 3.596786040736018*^9, 
   3.59678725289835*^9, {3.596798352518884*^9, 3.596798362296444*^9}, 
   3.5969129739279313`*^9, 3.5973460470834723`*^9, 3.5973464800892386`*^9, 
   3.5973466069114923`*^9, 3.5973500929788837`*^9, 3.597643972715186*^9, 
   3.5976469040598497`*^9, 3.614948439070137*^9, 3.6190837580221777`*^9, 
   3.619084118020768*^9, 3.619087303141947*^9, 3.6277327168240757`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"length", " ", "L", " ", "should", " ", "be", " ", "conserved"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Total", "[", 
   SubscriptBox["r", 
    RowBox[{"data", ",", "0"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967834993776608`*^9, 3.5967835166946507`*^9}}],

Cell[BoxData["12.`"], "Output",
 CellChangeTimes->{{3.596783502721852*^9, 3.5967835176437054`*^9}, 
   3.596785823577597*^9, 3.596786041341052*^9, 3.596787253024357*^9, 
   3.59679836293548*^9, 3.596912975046995*^9, 3.5973460483835464`*^9, 
   3.597346481881341*^9, 3.5973466080795593`*^9, 3.59735014151466*^9, 
   3.5976439727341876`*^9, 3.597646904085851*^9, 3.614948440155199*^9, 
   3.6190837601893015`*^9, 3.6190841180337687`*^9, 3.6190873031559477`*^9, 
   3.627732717867135*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  SubscriptBox["q", 
   RowBox[{"data", ",", "0"}]], "=", 
  RowBox[{"Most", "[", 
   RowBox[{"Accumulate", "[", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], ",", "0"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.5967893805180426`*^9, 3.5967893899555826`*^9}, {
  3.5967895292355485`*^9, 3.596789530870642*^9}, {3.596789585013739*^9, 
  3.5967895863698163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0.9305516898626545`", ",", "2.8245212007717155`", ",", 
   "4.887235199166847`", ",", "6.738203120773235`", ",", "8.60306248063019`", 
   ",", "9.51504677445221`", ",", "11.184560735035308`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5967893857503414`*^9, 3.596789393010757*^9}, 
   3.596789531457676*^9, 3.596789586848844*^9, 3.59679836363052*^9, 
   3.596912975866042*^9, 3.5973460496216173`*^9, 3.597346484030464*^9, 
   3.5973466090126123`*^9, 3.597350142319706*^9, 3.5976439727521887`*^9, 
   3.5976469041078525`*^9, 3.614948441208259*^9, 3.6190837634114857`*^9, 
   3.61908411804677*^9, 3.6190873031679487`*^9, 3.6277327189101954`*^9}],

Cell[BoxData["8"], "Output",
 CellChangeTimes->{{3.5967893857503414`*^9, 3.596789393010757*^9}, 
   3.596789531457676*^9, 3.596789586848844*^9, 3.59679836363052*^9, 
   3.596912975866042*^9, 3.5973460496216173`*^9, 3.597346484030464*^9, 
   3.5973466090126123`*^9, 3.597350142319706*^9, 3.5976439727521887`*^9, 
   3.5976469041078525`*^9, 3.614948441208259*^9, 3.6190837634114857`*^9, 
   3.61908411804677*^9, 3.6190873031679487`*^9, 3.6277327189151955`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "check", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Norm", "[", 
   RowBox[{
    RowBox[{"FieldDifferences", "[", 
     RowBox[{
      SubscriptBox["q", 
       RowBox[{"data", ",", "0"}]], ",", 
      RowBox[{"Total", "[", 
       SubscriptBox["r", 
        RowBox[{"data", ",", "0"}]], "]"}]}], "]"}], "-", 
    SubscriptBox["r", 
     RowBox[{"data", ",", "0"}]]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.59678844336244*^9, 3.5967885341766343`*^9}, {
  3.596792476552126*^9, 3.5967925323233156`*^9}, {3.5967925714115515`*^9, 
  3.5967926144290113`*^9}, {3.5969155004054375`*^9, 3.59691553087718*^9}, {
  3.596915578783921*^9, 3.5969155789929323`*^9}}],

Cell[BoxData["1.5100665727558131`*^-15"], "Output",
 CellChangeTimes->{{3.5967925072888837`*^9, 3.5967925355595007`*^9}, {
   3.596792594332862*^9, 3.596792614977043*^9}, 3.5967983672287254`*^9, 
   3.596912976753093*^9, 3.5969155329252977`*^9, 3.5969155794329576`*^9, 
   3.5973460508686886`*^9, 3.597346485732561*^9, 3.5973466101746793`*^9, 
   3.5973501433607655`*^9, 3.59764397277619*^9, 3.597646904131854*^9, 
   3.614948443726403*^9, 3.619083766420658*^9, 3.6190841180617704`*^9, 
   3.6190873031839495`*^9, 3.6277327200752616`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"load", " ", "momentum", " ", "data", " ", "from", " ", "disk"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["p", 
    RowBox[{"data", ",", "0"}]], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<collision_test_field_p0.dat\>\"", ",", "\"\<Real64\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.596782172919791*^9, 3.596782194764041*^9}, {
  3.5967988456820917`*^9, 3.5967988462061214`*^9}, {3.597346489663786*^9, 
  3.5973464910828676`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.3762577233315173`", ",", "0.13131257595043683`", ",", 
   RowBox[{"-", "0.24437916512130975`"}], ",", "1.1716921626027217`", ",", 
   RowBox[{"-", "0.46479647171447025`"}], ",", "0.21352569946405375`", ",", 
   RowBox[{"-", "0.738633599358192`"}], ",", 
   RowBox[{"-", "0.4449789251547574`"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.5967821769490223`*^9, 3.5967821985022545`*^9}, 
   3.5967826635918565`*^9, 3.5967835203648605`*^9, 3.596785824379643*^9, 
   3.596786041906085*^9, 3.5967872531663647`*^9, 3.5967895373590136`*^9, 
   3.5967895880929155`*^9, 3.59679884670815*^9, 3.596912977732149*^9, 
   3.596915581727089*^9, 3.597346054007868*^9, 3.597346492245934*^9, 
   3.5973466124148073`*^9, 3.5973501445608344`*^9, 3.5976439728221927`*^9, 
   3.597646904181857*^9, 3.614948446346553*^9, 3.619083768485776*^9, 
   3.6190841180947723`*^9, 3.6190873032169514`*^9, 3.6277327223053894`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "total", " ", "momentum", " ", "is", " ", "zero", " ", "by", " ", 
    "convention"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Total", "[", 
   SubscriptBox["p", 
    RowBox[{"data", ",", "0"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967896123303013`*^9, 3.596789630357332*^9}}],

Cell[BoxData["2.7755575615628914`*^-16"], "Output",
 CellChangeTimes->{{3.596789613634376*^9, 3.5967896308063583`*^9}, 
   3.5969129787592077`*^9, 3.596915582375126*^9, 3.5973460551139317`*^9, 
   3.5973464936750154`*^9, 3.597350145461886*^9, 3.5976439728411937`*^9, 
   3.5976469041988573`*^9, 3.614948447360611*^9, 3.61908376942583*^9, 
   3.6190841181067734`*^9, 3.6190873032289515`*^9, 3.627732723476456*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["V", "pot"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "1", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.596782481000413*^9, 3.59678250944304*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VisualizeField", "[", 
  RowBox[{
   RowBox[{"Accumulate", "[", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], ",", "0.4"}], "]"}], "]"}], ",", 
   SubscriptBox["V", "pot"], ",", "14"}], "]"}]], "Input",
 CellChangeTimes->{{3.5967825151643667`*^9, 3.5967825436219945`*^9}, {
  3.596783115201687*^9, 3.596783131740633*^9}, {3.5973500461692066`*^9, 
  3.5973500462862134`*^9}, {3.597350151944257*^9, 3.597350171892398*^9}}],

Cell[BoxData[
 GraphicsBox[{{PointBox[{0.4, 0}], PointBox[{1.3305516898626544`, 0}], 
    PointBox[{3.2245212007717154`, 0}], PointBox[{5.2872351991668465`, 0}], 
    PointBox[{7.138203120773236, 0}], PointBox[{9.00306248063019, 0}], 
    PointBox[{9.915046774452211, 0}], PointBox[{11.58456073503531, 0}], 
    PointBox[{12.400000000000002`, 0}]}, 
   {RGBColor[1, 0, 0], CircleBox[{0.4, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{1.3305516898626544`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{3.2245212007717154`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{5.2872351991668465`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{7.138203120773236, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{9.00306248063019, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{9.915046774452211, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{11.58456073503531, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{12.400000000000002`, 0}, NCache[Rational[1, 4], 0.25]]}, 
   {RGBColor[1, 0.5, 0], CircleBox[{0.4, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{1.3305516898626544`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{3.2245212007717154`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{5.2872351991668465`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{7.138203120773236, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{9.00306248063019, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{9.915046774452211, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{11.58456073503531, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{12.400000000000002`, 0}, NCache[Rational[1, 2], 0.5]]}, 
   {GrayLevel[0.5], LineBox[{{0, 0}, {14, 0}}]}},
  ImageSize->Large,
  PlotRange->{{-1, 16}, All}]], "Output",
 CellChangeTimes->{{3.5967835637003393`*^9, 3.5967835773571205`*^9}, {
   3.5967836856103125`*^9, 3.596783708481621*^9}, 3.596785826967791*^9, 
   3.5967860434901752`*^9, 3.596787253198367*^9, 3.596789589993024*^9, {
   3.5967946449301496`*^9, 3.596794671442666*^9}, 3.596913903348091*^9, 
   3.596915584701259*^9, 3.597346059352174*^9, 3.5973464988433113`*^9, {
   3.5973501488600807`*^9, 3.597350172145412*^9}, 3.597643972924198*^9, 
   3.5976469042338595`*^9, 3.6149484515758524`*^9, 3.619083773154043*^9, 
   3.619084118124774*^9, 3.619087303244953*^9, 3.6277327274666843`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"without", " ", "collision", " ", "detection"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"VisualizeField", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], "+", "0.4", "+", 
       RowBox[{"t", " ", 
        SubscriptBox["p", 
         RowBox[{"data", ",", "0"}]]}]}], ",", 
      SubscriptBox["V", "pot"], ",", "12"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967822229996557`*^9, 3.5967822286809807`*^9}, {
  3.596782266410139*^9, 3.5967823531551003`*^9}, {3.596782464601475*^9, 
  3.596782473984011*^9}, {3.59678270771338*^9, 3.5967828467173305`*^9}, {
  3.596782881907343*^9, 3.5967829128851147`*^9}, {3.596782996939923*^9, 
  3.5967830590674763`*^9}, {3.5967831682717223`*^9, 3.5967831897649517`*^9}, {
  3.596783373252446*^9, 3.596783390922457*^9}, {3.5967835297073956`*^9, 
  3.5967835331135902`*^9}, {3.5967894412025137`*^9, 3.596789484443987*^9}, {
  3.5967895442364063`*^9, 3.5967895944082766`*^9}, {3.5973501839230857`*^9, 
  3.5973501860802093`*^9}, {3.6277333214036555`*^9, 3.627733329549122*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 1.71209716796875, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 10}}, Typeset`size$$ = {576., {18., 23.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$1534$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$1534$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`VisualizeField[
       Subscript[$CellContext`q, $CellContext`data, 0] + 
        0.4 + $CellContext`t$$ 
         Subscript[$CellContext`p, $CellContext`data, 0], 
        Subscript[$CellContext`V, $CellContext`pot], 12], 
      "Specifications" :> {{$CellContext`t$$, 0, 10, AnimationRunning -> 
         False, AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {56., 63.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.597643988821108*^9, 3.597646904295863*^9, 3.6149484573691835`*^9, 
   3.619083776681245*^9, 3.619084118154776*^9, 3.6190873032699537`*^9, 
   3.627732730800875*^9, {3.6277333107850485`*^9, 3.6277333302551622`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run simulation", "Section",
 CellChangeTimes->{{3.5973487644628973`*^9, 3.5973487673450623`*^9}, {
  3.5973497829601517`*^9, 3.597349785121276*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"PredictCollision", "[", 
    RowBox[{"1.2", ",", 
     RowBox[{"-", "1.6"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", "1"}], "}"}]}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"PredictCollision", "[", 
    RowBox[{"1.2", ",", 
     RowBox[{"-", "2.6"}], ",", 
     RowBox[{"{", 
      RowBox[{
       FractionBox["1", "2"], ",", "1", ",", "1"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5967857551056805`*^9, 3.596785755249689*^9}, {
  3.5967859145638013`*^9, 3.59678594810672*^9}, {3.596787121933859*^9, 
  3.5967871578719144`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", "1.6`", ",", "0.12499999999999997`", ",", "PlatBounce"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.596785755999732*^9, {3.5967858040924826`*^9, 3.5967858385984564`*^9}, {
   3.5967859155788593`*^9, 3.596785948856763*^9}, {3.5967860123963966`*^9, 
   3.596786049949545*^9}, {3.596787117427601*^9, 3.5967871580939274`*^9}, 
   3.596787253294372*^9, 3.596789673181782*^9, 3.5969139109205246`*^9, 
   3.5969143116204433`*^9, 3.5973460683596888`*^9, 3.5973465031475573`*^9, 
   3.5973502031181836`*^9, 3.5976439732072144`*^9, 3.597646904344866*^9, 
   3.614948466434702*^9, 3.6190837920171223`*^9, 3.6190841181847773`*^9, 
   3.6190873032979555`*^9, 3.6277333361264973`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", ",", 
   RowBox[{"-", "1.661324772583615`"}], ",", "0.0769230769230769`", ",", 
   "PlatIn"}], "}"}]], "Output",
 CellChangeTimes->{
  3.596785755999732*^9, {3.5967858040924826`*^9, 3.5967858385984564`*^9}, {
   3.5967859155788593`*^9, 3.596785948856763*^9}, {3.5967860123963966`*^9, 
   3.596786049949545*^9}, {3.596787117427601*^9, 3.5967871580939274`*^9}, 
   3.596787253294372*^9, 3.596789673181782*^9, 3.5969139109205246`*^9, 
   3.5969143116204433`*^9, 3.5973460683596888`*^9, 3.5973465031475573`*^9, 
   3.5973502031181836`*^9, 3.5976439732072144`*^9, 3.597646904344866*^9, 
   3.614948466434702*^9, 3.6190837920171223`*^9, 3.6190841181847773`*^9, 
   3.6190873032979555`*^9, 3.627733336129498*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NextCollision", "[", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"data", ",", "0"}]], ",", 
    SubscriptBox["p", 
     RowBox[{"data", ",", "0"}]], ",", 
    SubscriptBox["V", "pot"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967854220366306`*^9, 3.5967854638080196`*^9}, {
  3.5967855063464527`*^9, 3.5967855065524645`*^9}, {3.5967855530041213`*^9, 
  3.5967855623036532`*^9}, {3.596787026235385*^9, 3.596787044739444*^9}, {
  3.596787892574937*^9, 3.596787896550164*^9}, {3.5969147075420885`*^9, 
  3.5969147101372366`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "2.162042930382505`", ",", "0.22473514227049704`", ",", "PlatOut",
    ",", "8"}], "}"}]], "Output",
 CellChangeTimes->{
  3.596785510285678*^9, {3.596785548471862*^9, 3.5967855729632626`*^9}, {
   3.596785626428321*^9, 3.596785636924921*^9}, {3.596785675940153*^9, 
   3.596785692393094*^9}, {3.5967857430479913`*^9, 3.5967857645912232`*^9}, {
   3.5967858071266565`*^9, 3.5967858311710315`*^9}, {3.5967860156775846`*^9, 
   3.5967860487894783`*^9}, 3.5967860849965496`*^9, 3.596786130482151*^9, 
   3.596787045442484*^9, 3.596787253322374*^9, 3.5967878974222145`*^9, 
   3.5967896751108923`*^9, 3.596913913574676*^9, 3.596914314069583*^9, 
   3.596914710700269*^9, 3.596915636131201*^9, 3.596915843358053*^9, 
   3.597346069620761*^9, 3.5973465044486322`*^9, 3.5973502042032456`*^9, 
   3.597643973235216*^9, 3.597646904364867*^9, 3.614948469252863*^9, 
   3.6190837965563817`*^9, 3.6190841182007785`*^9, 3.619087303312957*^9, 
   3.627733337248562*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CollisionInfo", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["q", 
       RowBox[{"data", ",", "0"}]], ",", 
      SubscriptBox["p", 
       RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
    RowBox[{"Total", "[", 
     SubscriptBox["r", 
      RowBox[{"data", ",", "0"}]], "]"}], ",", 
    SubscriptBox["V", "pot"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5969164681147876`*^9, 3.596916474195135*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.22473514227049624`", ",", "PlatOut", ",", "8", ",", 
   RowBox[{"{", 
    RowBox[{"0.6704031409481152`", ",", "0.47696454522398524`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.596916482018583*^9, 3.5973460707248244`*^9, 
  3.597346505765707*^9, 3.5973502090375223`*^9, 3.597643973264218*^9, 
  3.5976469043848686`*^9, 3.614948474301152*^9, 3.6190838072649937`*^9, 
  3.6190841182157793`*^9, 3.6190873033339577`*^9, 3.627733338175615*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"UpdateField", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
     RowBox[{"Total", "[", 
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], "]"}], ",", 
     SubscriptBox["V", "pot"]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Differences", "[", 
    RowBox[{"First", "[", "%", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5967883007112813`*^9, 3.5967883196773663`*^9}, {
   3.596788399616938*^9, 3.5967884279695597`*^9}, {3.59678893814074*^9, 
   3.596788944115082*^9}, {3.5967892892898245`*^9, 3.596789294847142*^9}, 
   3.596789368987383*^9, {3.5967896997032986`*^9, 3.5967897028944817`*^9}, {
   3.5967924655864983`*^9, 3.5967924693947163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.08455833298328155`", ",", "0.9600622403007812`", ",", 
     "2.769600614330233`", ",", "5.150555604026595`", ",", 
     "6.633747019575659`", ",", "8.651049209077652`", ",", 
     "9.349049847414678`", ",", "11.084558332983281`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.0466608642796325`", ",", "0.13131257595043683`", ",", 
     RowBox[{"-", "0.24437916512130975`"}], ",", "1.1716921626027217`", ",", 
     RowBox[{"-", "0.46479647171447025`"}], ",", "0.21352569946405375`", ",", 
     RowBox[{"-", "0.738633599358192`"}], ",", 
     RowBox[{"-", "1.1153820661028724`"}]}], "}"}], ",", 
   "0.22473514227049624`"}], "}"}]], "Output",
 CellChangeTimes->{{3.596788428437587*^9, 3.5967884386511707`*^9}, 
   3.5967887181091547`*^9, 3.5967887607175922`*^9, {3.5967888267623696`*^9, 
   3.59678885387292*^9}, {3.596788940639883*^9, 3.596788944450101*^9}, 
   3.596789295642188*^9, {3.5967896813752503`*^9, 3.5967897036445246`*^9}, 
   3.596789895630505*^9, 3.596789954313862*^9, 3.5967923972675905`*^9, {
   3.5967924592361355`*^9, 3.596792469662731*^9}, 3.596913918066933*^9, 
   3.5969143158816867`*^9, 3.5969156772695537`*^9, 3.596915845010148*^9, 
   3.5973460744000344`*^9, 3.597346509620928*^9, 3.597350212521722*^9, 
   3.5976439733092203`*^9, 3.5976469044048696`*^9, 3.6149484811815453`*^9, 
   3.619083814051382*^9, 3.61908411822978*^9, 3.6190873033479586`*^9, 
   3.627733341275792*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.8755039073174997`", ",", "1.8095383740294517`", ",", 
   "2.3809549896963618`", ",", "1.4831914155490642`", ",", 
   "2.0173021895019927`", ",", "0.6980006383370263`", ",", 
   "1.7355084855686034`"}], "}"}]], "Output",
 CellChangeTimes->{{3.596788428437587*^9, 3.5967884386511707`*^9}, 
   3.5967887181091547`*^9, 3.5967887607175922`*^9, {3.5967888267623696`*^9, 
   3.59678885387292*^9}, {3.596788940639883*^9, 3.596788944450101*^9}, 
   3.596789295642188*^9, {3.5967896813752503`*^9, 3.5967897036445246`*^9}, 
   3.596789895630505*^9, 3.596789954313862*^9, 3.5967923972675905`*^9, {
   3.5967924592361355`*^9, 3.596792469662731*^9}, 3.596913918066933*^9, 
   3.5969143158816867`*^9, 3.5969156772695537`*^9, 3.596915845010148*^9, 
   3.5973460744000344`*^9, 3.597346509620928*^9, 3.597350212521722*^9, 
   3.5976439733092203`*^9, 3.5976469044048696`*^9, 3.6149484811815453`*^9, 
   3.619083814051382*^9, 3.61908411822978*^9, 3.6190873033479586`*^9, 
   3.6277333412777925`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["f", "seq"], "=", 
   RowBox[{"FieldSequence", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
     RowBox[{"Total", "[", 
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], "]"}], ",", 
     SubscriptBox["V", "pot"], ",", "32"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6190839096918526`*^9, 3.6190839101298776`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["f", "seq"], "\[LeftDoubleBracket]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.5967932520064793`*^9, 3.59679326076398*^9}, {
   3.5969139536539683`*^9, 3.5969139590232754`*^9}, 3.596914004326867*^9, {
   3.59734610998407*^9, 3.59734611506536*^9}, {3.597350220978205*^9, 
   3.5973502211202135`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0.9305516898626545`", ",", "2.8245212007717155`", ",", 
       "4.887235199166847`", ",", "6.738203120773235`", ",", 
       "8.60306248063019`", ",", "9.51504677445221`", ",", 
       "11.184560735035308`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.3762577233315173`", ",", "0.13131257595043683`", ",", 
       RowBox[{"-", "0.24437916512130975`"}], ",", "1.1716921626027217`", ",", 
       RowBox[{"-", "0.46479647171447025`"}], ",", "0.21352569946405375`", 
       ",", 
       RowBox[{"-", "0.738633599358192`"}], ",", 
       RowBox[{"-", "0.4449789251547574`"}]}], "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.08455833298328182`", ",", "0.9600622403007814`", ",", 
       "2.7696006143302325`", ",", "5.150555604026596`", ",", 
       "6.633747019575659`", ",", "8.651049209077652`", ",", 
       "9.34904984741468`", ",", "11.084558332983281`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1.0466608642796325`", ",", "0.13131257595043683`", ",", 
       RowBox[{"-", "0.24437916512130975`"}], ",", "1.1716921626027217`", ",", 
       RowBox[{"-", "0.46479647171447025`"}], ",", "0.21352569946405375`", 
       ",", 
       RowBox[{"-", "0.738633599358192`"}], ",", 
       RowBox[{"-", "1.1153820661028724`"}]}], "}"}], ",", 
     "0.22473514227049693`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.23770932158593028`", ",", "1.2518449515036973`", ",", 
       "3.69070877411329`", ",", "4.768652333377881`", ",", 
       "5.768652333377881`", ",", "8.131184570347157`", ",", 
       "9.968625435013202`", ",", "10.86580348137315`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.38595949979309063`"}], ",", 
       RowBox[{"-", "0.24437916512130986`"}], ",", "0.5223674052095294`", ",", 
       RowBox[{"-", "0.7386335993581921`"}], ",", "1.5740602188164519`", ",", 
       "1.0466608642796325`", ",", 
       RowBox[{"-", "0.4274009287885252`"}], ",", 
       RowBox[{"-", "1.3467152952444954`"}]}], "}"}], ",", 
     "4.389393214988477`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.596793252284495*^9, 3.5967932611950045`*^9}, 
   3.5967947041505365`*^9, 3.5969139262253995`*^9, 3.596913959711315*^9, 
   3.596914004511877*^9, 3.5969143237441363`*^9, 3.59691585449269*^9, 
   3.5969171371330533`*^9, 3.597346081194423*^9, 3.5973461157103972`*^9, 
   3.5973465143071957`*^9, {3.597350216899972*^9, 3.597350221665244*^9}, 
   3.597643973361223*^9, 3.597646904448872*^9, 3.6149484855747967`*^9, 
   3.61908382100478*^9, 3.6190839113529477`*^9, 3.619084118252782*^9, 
   3.61908730337096*^9, 3.6277333452540197`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Interpolation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Last", "[", "#", "]"}], ",", 
       RowBox[{"First", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    SubscriptBox["f", "seq"]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VisualizeField", "[", 
    RowBox[{
     RowBox[{"%", "[", "t", "]"}], ",", 
     SubscriptBox["V", "pot"], ",", "12"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "4"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5967902258253913`*^9, 3.596790243615409*^9}, {
   3.5967929736985607`*^9, 3.596793015417947*^9}, {3.5967931032839727`*^9, 
   3.5967931211919966`*^9}, {3.596793152111765*^9, 3.596793174019018*^9}, {
   3.5967932161084256`*^9, 3.5967932227328043`*^9}, 3.59679327387673*^9, {
   3.596800106512207*^9, 3.5968001117875085`*^9}, 3.5973462614357324`*^9, {
   3.5973502286416435`*^9, 3.5973502287746515`*^9}, 3.619087342063173*^9}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["InterpolatingFunction", "SummaryHead"], 
       "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "4.389393214988477`"}], "}"}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output dimensions: \"", "SummaryItemAnnotation"],
                    "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "8", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "4.389393214988477`"}], "}"}], "}"}], 
                    "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output dimensions: \"", "SummaryItemAnnotation"],
                    "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "8", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Order: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"Hermite\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Periodic: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["False", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("InterpolatingFunction[{{0., 4.38939}}, <>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.596790244582464*^9, 3.59679038997478*^9, 3.5967924125354643`*^9, 
   3.5967926629387865`*^9, {3.5967929967938814`*^9, 3.5967930157159643`*^9}, 
   3.596793122870093*^9, {3.5967931534238405`*^9, 3.5967931745640497`*^9}, {
   3.5967932191466*^9, 3.5967932232438335`*^9}, 3.596793275240808*^9, 
   3.596794705362606*^9, 3.596913931897724*^9, 3.597346084540614*^9, 
   3.597346262605799*^9, 3.5973502293396835`*^9, 3.5976439733992257`*^9, 
   3.597646904553878*^9, 3.614948489862042*^9, 3.6190838233399134`*^9, 
   3.6190839124290094`*^9, 3.619084118267782*^9, 3.619087303384961*^9, 
   3.6190873429872255`*^9, 3.627733349537265*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 0.565060806274414, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 4}}, Typeset`size$$ = {576., {18., 23.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$1666$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$1666$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`VisualizeField[
        InterpolatingFunction[{{0., 4.389393214988477}}, {
         4, 3, 0, {33}, {2}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0., 
         0.22473514227049693`, 0.43268420980776856`, 0.5199962308088056, 
         0.6349657748124714, 0.9271985848762259, 1.1138475005965522`, 
         1.142632538447147, 1.2889781381501066`, 1.5075980647464475`, 
         1.71101006224727, 1.8428189625045879`, 2.242118374981392, 
         2.3795293140030385`, 2.3849572335671563`, 2.5136156518604587`, 
         2.549192651930103, 2.7050846059900477`, 2.902313331369115, 
         3.0252119784129388`, 3.0684396393666074`, 3.1306570948242576`, 
         3.3041025268926876`, 3.3796127622693453`, 3.453574046594846, 
         3.528268529579872, 3.6337822405114895`, 3.9588308722841754`, 
         4.112439971500209, 4.1268242075330495`, 4.277546867980503, 
         4.289551454121495, 4.389393214988477}}, CompressedData["
1:eJxF1HlUzHsfB/BK0zI1bdOMmraZ+U0ziIdSaJvvO7qILGlFQipXy1NP6YmQ
UKHcMtlGVBRSImu3jdtKlituWfKQNoaS0s6NbueYc57POe/z+v+z8fzDVwVO
UlBQ4E1EcSJqCv8vNfcgL/17PeSCv1N6llQFwVw3//2HmHjCeZ7QPcBBQfx4
Rq01D9HrRm1uqlIIts65E+cnhPn22uDM87eI56ekyKaSz0To+GmdYIoK3A1S
iUWGPly0D30bPMBBnDB4ldcyHqpz/fKLr/PRf+CZ3VILISL+TT8X7N1ILh6T
jiRKe0ncPpM2nUoajv/Cdbh0hIVkqr34b3MOrtH0xXoBPLl8+PedpCffNIef
ypLsolnN5PiOz1Mjh3vJzi9BNL+jNBRtOrgsbIwl1xCUgcdsxgIe2hiRbzLD
+FDuawu7vNcc3zqzq0wjW0lcf8MGbds+IivZkdy4hgY+rXL8Zh0LfTU3wv2S
ONjy2+mE9Mk8jGdKU2bG8jEvyj+Y5mSOkCt/HIwtbCOO4inv35kMkd9rUywl
9crIu3PVNcuOBacaj9U/Oo1ApGUOWvlcxB5+6snP4MsVwHDmQ7/50e3kXvlQ
GUs8SmrrdB4IQ5SRxjq6qr5NHwEdooHeWmNc/3Lka4w/F3ksN17KTD68HkvM
kq8IEDH32ALbo+3k9vZbv+4qHSUtFWtu3vFVhva5Ck1Wkz7sxk6snlZkjItN
pQUVUVyYu4s6OWZ8zHC+XlF0TYCK6E2/XLDsIOe/nfBQEI2Si87aRpHHabBs
nX43LFUfh+seXN0OY+TPVX25/yFXLg+jVE9KUZUAl7xz1/5l3Elsbi3sn+Y6
QvwHHCz0QlQRKIvx3CDUR5LR20ump4xwfZvhmSvLuXL5sLoeZXK8WYCDbvcj
c0Y6iWNChjQ1fpi06T96ZWCmDjVuT1taHRP07CIvZ0Uj7EiSqTQEmWH21bla
jb18uQK86a1bFpr4jrwWRx7KGhsibEni3FxbOtgGaQ2NSUz8lrk/MD2TI9cU
FrtaaA4/+KAqCmzEPuZQ1L7vM2glI9WPhmifQweJZelAdJqEgZOvv5bdq9eD
6WhdW7+9AW54C2+mhptgR3Tdio6pFPbkU7qSo0LkTa6S1d6VkaaU1ij/jgGS
xtGYXq3FwHS3+q8MXyZqcoPKpwRPRnH/cs0zqiZwuX1Q5+M8CqsaW91DFUXo
CF9jICuXEXvv1U3L3g+QzY1G0SfUGYiYreX8diNT7mR4pezTTJxkAuk1/rd4
WwpHx1abldJEmOUTm+1Z9p5ouVwcjrcYJC+4DRpmaZq4fVetdtclJsbT/hSX
vGHD7vRUnk2OMWb4hNZJFlHYd35k9fkQEdamWdos2vWBXLknzcgVD5KND175
O4VpYjBijlPzH0zExkZYzihlQzmjZovrfmN0uQm3Ry+l0DoYctdyswg7FYaM
vwo+kh62JCeTM0r+7Mrf+/qlBnSvSRkMQ325bFAKGis26Rrjjl5MdLwvhVSH
mrVX3UUIoAdE8L9+JFY0q3mSsTFyeuP6AFMTDSR4d6+MWT4x//7p2h8OshHt
k2U/Z6cRKqrKfXQiKZxQ3PJWyV6E4igt79StH8hK3xuzuxMVYK007zDvIh3X
/0W9sHuiJ5eNvq3pEiczI7yLeti3ezcF078UFuZYiHDyxPtZbd0y4lg5z+aa
gyI+XRo/8HccHe0zWqT2qXq4a5kdk/aDLZcDrScxNbYJFKqeKObaCkWwsnLZ
PFUkIy97nvVWLVDCT+koKihzE8/Uw+/zp2+Ob2Dj1EBsuNjJCOPHh7RUUyjs
9M0qjzAVIap4qK9G6R2psm4p6IhURr64Ja/VlQ4Ps173CKEuJO1JkStd2RA6
6Fym/jbC/DRnt++ZE/u3yE/rtpoI2h4ltcr6neSp1tkVK4Jo+Kk6eK7jyaFT
dCFOM0qazWSjOrPsta6rMQ4sG8sVX6Dg4s3zWzIuRNOZJd4W0zrI1cVV1dsS
lPGqJragwoOOno2Onn7TdFHYEJY4/38s8G+XMbxPGWNPSdtpjysUvuu4LlUf
FiLOZ2uUgridbDg5Uz/wzCRseJNiUuBDR//6nkM1ObpyWcifUhsc2G0MTsQA
Z3cxhagg+4qrn4QYM5z5Y1NfKwnjPAqe46eEn9LRVNp2+ayWHrYIywVTJSwo
6Vk/2+FrgsO3jgjUqikkYf34zrdCFOaVqro1N5PCnsFD+kHfiPbzmEcDpRoQ
B3Slf17DlMuC5wuu55sSU0RbhKyVvKNgq+e86GmxEFcuUfeHGM9Jd9fiyF37
hoivbnPLYj9NdHPojOVOTMgqBx+PjLDg/Hzp8O51ZtgxXBTlO0zhv9kqY9Lc
if4FBeftt20iqXvC1CpDh0jJ1INLCyfux2XIolgmZmJb5UL3QhU2XBRsL3SF
muH7F5lK7wiFOe72jo/OCqH34VyzZstTsjemw3973CDx3yd71TXxP6iHXjHV
5kysqwg3rz7DhsT3fJ6dKhdrLU57bVETyBXieHqhYOzyU3JBYKG+O2SQpPWp
H642YuB7xN7qKoqJrFk1baqX2XBIpyfnM7goOBb3vJ4mgM4sCw++ghD1Diy3
+WGPyWhvYHqq6iCpnLR+VXoSA8m/yqSGTKbcyRivvpM9bQEX1h+XFPb2UvhP
Il26pNwc/wC125AP
         "], {Automatic}][$CellContext`t$$], 
        Subscript[$CellContext`V, $CellContext`pot], 12], 
      "Specifications" :> {{$CellContext`t$$, 0, 4, AnimationRunning -> False,
          AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {56., 63.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.596790244582464*^9, 3.59679038997478*^9, 3.5967924125354643`*^9, 
   3.5967926629387865`*^9, {3.5967929967938814`*^9, 3.5967930157159643`*^9}, 
   3.596793122870093*^9, {3.5967931534238405`*^9, 3.5967931745640497`*^9}, {
   3.5967932191466*^9, 3.5967932232438335`*^9}, 3.596793275240808*^9, 
   3.596794705362606*^9, 3.596913931897724*^9, 3.597346084540614*^9, 
   3.597346262605799*^9, 3.5973502293396835`*^9, 3.5976439733992257`*^9, 
   3.597646904553878*^9, 3.614948489862042*^9, 3.6190838233399134`*^9, 
   3.6190839124290094`*^9, 3.619084118267782*^9, 3.619087303384961*^9, 
   3.6190873429872255`*^9, 3.627733349583267*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Compare with C implementation", "Section",
 CellChangeTimes->{{3.5973492095113525`*^9, 3.597349212176505*^9}, {
  3.597349243104274*^9, 3.597349246965495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"\"\<collision_test_event_\>\"", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["coll", "test"], "=", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{"(*", " ", 
     RowBox[{"event", " ", "times"}], " ", "*)"}], 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{
       RowBox[{"%", "<>", "\"\<time.dat\>\""}], ",", "\"\<Real64\>\""}], 
      "]"}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"event", " ", "types"}], " ", "*)"}], " ", 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"%", "<>", "\"\<type.dat\>\""}], ",", "\"\<Integer32\>\""}], 
       "]"}], "/.", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"0", "\[Rule]", "PlatIn"}], ",", 
        RowBox[{"1", "\[Rule]", "PlatOut"}], ",", 
        RowBox[{"2", "\[Rule]", "PlatBounce"}], ",", 
        RowBox[{"3", "\[Rule]", "Core"}]}], "}"}]}], ",", 
     RowBox[{"(*", " ", 
      RowBox[{"particle", " ", "indices"}], " ", "*)"}], 
     RowBox[{
      RowBox[{"Import", "[", 
       RowBox[{
        RowBox[{"%", "<>", "\"\<iprt.dat\>\""}], ",", "\"\<Integer32\>\""}], 
       "]"}], "+", "1"}]}], "}"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.5969140773820457`*^9, 3.596914080047198*^9}, {
  3.596914150474226*^9, 3.5969141549094796`*^9}, {3.596914341738166*^9, 
  3.596914446926182*^9}, {3.596914532286064*^9, 3.5969145551853743`*^9}, {
  3.5969146278525305`*^9, 3.5969146303196716`*^9}, {3.597346522123643*^9, 
  3.597346523279709*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.22473514227049704`", ",", "PlatOut", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.4326842098077666`", ",", "Core", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5199962308088051`", ",", "PlatBounce", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6349657748124714`", ",", "Core", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9271985848762265`", ",", "PlatBounce", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1138475005965498`", ",", "PlatBounce", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1426325384471472`", ",", "PlatBounce", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2889781381501053`", ",", "Core", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5075980647464462`", ",", "PlatOut", ",", "6"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5969140816732907`*^9, 3.596914330081499*^9, {3.5969143668816037`*^9, 
   3.596914375709109*^9}, {3.596914410765114*^9, 3.5969144475992203`*^9}, {
   3.5969145361372848`*^9, 3.5969145559664187`*^9}, 3.5969146316627483`*^9, 
   3.5969158586789293`*^9, 3.596916904795764*^9, 3.5969171299736433`*^9, 
   3.596917159996361*^9, 3.597346089038872*^9, 3.5973462856361165`*^9, 
   3.5973465269419184`*^9, 3.59735024239143*^9, 3.597643973581236*^9, 
   3.5976469047128873`*^9, 3.6149485020777407`*^9, 3.6190838476943064`*^9, 
   3.6190841185267973`*^9, 3.6190873546328917`*^9, 3.627733365160158*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Most", "[", 
     RowBox[{"CollisionInfo", "[", 
      RowBox[{
       RowBox[{"AdvanceField", "[", 
        RowBox[{"#", ",", "0.0001"}], "]"}], ",", 
       RowBox[{"Total", "[", 
        SubscriptBox["r", 
         RowBox[{"data", ",", "0"}]], "]"}], ",", 
       SubscriptBox["V", "pot"]}], "]"}], "]"}], "&"}], "/@", 
   RowBox[{
    SubscriptBox["f", "seq"], "\[LeftDoubleBracket]", 
    RowBox[{"1", ";;", "9"}], "\[RightDoubleBracket]"}]}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "compare", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Norm", "[", 
  RowBox[{"%", "-", 
   SubscriptBox["coll", "test"]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5969146763713055`*^9, 3.59691468921104*^9}, {
   3.5969148489101744`*^9, 3.5969148528664007`*^9}, {3.5969149597155123`*^9, 
   3.5969149995127883`*^9}, {3.5969150311295967`*^9, 3.596915050456702*^9}, {
   3.5969165222298827`*^9, 3.5969165525946198`*^9}, {3.596916628065936*^9, 
   3.5969166664481316`*^9}, {3.5969168917110157`*^9, 
   3.5969168923230505`*^9}, {3.6149485294743075`*^9, 3.614948532247466*^9}, 
   3.619083876799971*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.22473514227049693`", ",", "PlatOut", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.43268420980776856`", ",", "Core", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5199962308088056`", ",", "PlatBounce", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6349657748124714`", ",", "Core", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9271985848762259`", ",", "PlatBounce", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1138475005965522`", ",", "PlatBounce", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.142632538447147`", ",", "PlatBounce", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2889781381501066`", ",", "Core", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5075980647464475`", ",", "PlatOut", ",", "6"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.5969146901540937`*^9, {3.596915007952271*^9, 3.5969150508007216`*^9}, 
   3.596916553115649*^9, {3.5969166291809998`*^9, 3.5969166668021517`*^9}, {
   3.5969168927590756`*^9, 3.5969169056018105`*^9}, {3.5969171263914385`*^9, 
   3.5969171426933713`*^9}, 3.597346092974097*^9, 3.5973462864231615`*^9, 
   3.5973465302261066`*^9, 3.597350244556554*^9, 3.5976439736112375`*^9, 
   3.5976469047588897`*^9, {3.6149485038388414`*^9, 3.61494853335353*^9}, {
   3.6190838564568076`*^9, 3.619083877421007*^9}, 3.619084118540798*^9, 
   3.619087355699953*^9, 3.627733366994263*^9}],

Cell[BoxData["3.75552528532782`*^-15"], "Output",
 CellChangeTimes->{
  3.5969146901540937`*^9, {3.596915007952271*^9, 3.5969150508007216`*^9}, 
   3.596916553115649*^9, {3.5969166291809998`*^9, 3.5969166668021517`*^9}, {
   3.5969168927590756`*^9, 3.5969169056018105`*^9}, {3.5969171263914385`*^9, 
   3.5969171426933713`*^9}, 3.597346092974097*^9, 3.5973462864231615`*^9, 
   3.5973465302261066`*^9, 3.597350244556554*^9, 3.5976439736112375`*^9, 
   3.5976469047588897`*^9, {3.6149485038388414`*^9, 3.61494853335353*^9}, {
   3.6190838564568076`*^9, 3.619083877421007*^9}, 3.619084118540798*^9, 
   3.619087355699953*^9, 3.6277333669962635`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "reference", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["coll", "ref"], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Most", "[", 
      RowBox[{"CollisionInfo", "[", 
       RowBox[{
        RowBox[{"AdvanceField", "[", 
         RowBox[{"#", ",", "0.0001"}], "]"}], ",", 
        RowBox[{"Total", "[", 
         SubscriptBox["r", 
          RowBox[{"data", ",", "0"}]], "]"}], ",", 
        SubscriptBox["V", "pot"]}], "]"}], "]"}], "&"}], "/@", 
    RowBox[{
     SubscriptBox["f", "seq"], "\[LeftDoubleBracket]", 
     RowBox[{"1", ";;", "9"}], "\[RightDoubleBracket]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.59764415023734*^9, 3.597644249868039*^9}, {
   3.5976444252400694`*^9, 3.597644425564088*^9}, {3.61494854298008*^9, 
   3.614948547603345*^9}, 3.619083895414036*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.22473514227049693`", ",", "PlatOut", ",", "8"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.43268420980776856`", ",", "Core", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5199962308088056`", ",", "PlatBounce", ",", "4"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.6349657748124714`", ",", "Core", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.9271985848762259`", ",", "PlatBounce", ",", "7"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.1138475005965522`", ",", "PlatBounce", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.142632538447147`", ",", "PlatBounce", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.2889781381501066`", ",", "Core", ",", "6"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1.5075980647464475`", ",", "PlatOut", ",", "6"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.5976441001764765`*^9, 3.5976441531755085`*^9, 
  3.5976442290408473`*^9, 3.597644439462883*^9, 3.5976469047918916`*^9, 
  3.614948549537455*^9, 3.619083896302087*^9, 3.6190841185577993`*^9, 
  3.61908735704603*^9, 3.627733371883543*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"save", " ", "to", " ", "disk", " ", "for", " ", "comparison"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"\"\<collision_test_ref_event_\>\"", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"(*", " ", 
      RowBox[{"event", " ", "times"}], " ", "*)"}], 
     RowBox[{
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"%", "<>", "\"\<time.dat\>\""}], ",", 
        RowBox[{
         SubscriptBox["coll", "ref"], "\[LeftDoubleBracket]", 
         RowBox[{";;", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
        "\"\<Real64\>\""}], "]"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"event", " ", "types"}], " ", "*)"}], " ", 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"%", "<>", "\"\<type.dat\>\""}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["coll", "ref"], "\[LeftDoubleBracket]", 
          RowBox[{";;", ",", "2"}], "\[RightDoubleBracket]"}], "/.", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"PlatIn", "\[Rule]", "0"}], ",", 
           RowBox[{"PlatOut", "\[Rule]", "1"}], ",", 
           RowBox[{"PlatBounce", "\[Rule]", "2"}], ",", 
           RowBox[{"Core", "\[Rule]", "3"}]}], "}"}]}], ",", 
        "\"\<Integer32\>\""}], "]"}], ",", 
      RowBox[{"(*", " ", 
       RowBox[{"particle", " ", "indices"}], " ", "*)"}], 
      RowBox[{"Export", "[", 
       RowBox[{
        RowBox[{"%", "<>", "\"\<iprt.dat\>\""}], ",", 
        RowBox[{
         RowBox[{
          SubscriptBox["coll", "ref"], "\[LeftDoubleBracket]", 
          RowBox[{";;", ",", "3"}], "\[RightDoubleBracket]"}], "-", "1"}], 
        ",", "\"\<Integer32\>\""}], "]"}]}], "}"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.5976442729843607`*^9, 3.5976444480583744`*^9}, {
  3.5976467120228662`*^9, 3.5976467257726526`*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1067, 677},
WindowMargins->{{Automatic, 253}, {170, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 152, 2, 90, "Title"],
Cell[735, 26, 259, 5, 30, "Text"],
Cell[997, 33, 99, 1, 30, "Text"],
Cell[1099, 36, 191, 4, 31, "Input"],
Cell[1293, 42, 261, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[1579, 51, 159, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[1763, 57, 614, 14, 52, "Input"],
Cell[2380, 73, 795, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3212, 91, 332, 8, 52, "Input"],
Cell[3547, 101, 485, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[4069, 113, 524, 14, 52, "Input"],
Cell[4596, 129, 694, 11, 31, "Output"],
Cell[5293, 142, 458, 6, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5788, 153, 706, 17, 52, "Input"],
Cell[6497, 172, 538, 7, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7072, 184, 534, 13, 52, "Input"],
Cell[7609, 199, 937, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8583, 218, 351, 9, 52, "Input"],
Cell[8937, 229, 412, 5, 31, "Output"]
}, Open  ]],
Cell[9364, 237, 242, 7, 31, "Input"],
Cell[CellGroupData[{
Cell[9631, 248, 503, 11, 31, "Input"],
Cell[10137, 261, 2322, 34, 51, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[12496, 300, 1309, 27, 52, "Input"],
Cell[13808, 329, 2265, 45, 136, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[16122, 380, 154, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[16301, 386, 713, 20, 103, "Input"],
Cell[17017, 408, 722, 12, 31, "Output"],
Cell[17742, 422, 749, 13, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18528, 440, 638, 14, 52, "Input"],
Cell[19169, 456, 1007, 17, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[20213, 478, 540, 15, 52, "Input"],
Cell[20756, 495, 490, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21283, 509, 945, 22, 72, "Input"],
Cell[22231, 533, 1476, 26, 52, "Output"],
Cell[23710, 561, 1024, 17, 31, "Output"]
}, Open  ]],
Cell[24749, 581, 549, 16, 31, "Input"],
Cell[CellGroupData[{
Cell[25323, 601, 523, 11, 52, "Input"],
Cell[25849, 614, 2793, 58, 132, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28679, 677, 1123, 26, 52, "Input"],
Cell[29805, 705, 9584, 191, 81, "Output"],
Cell[39392, 898, 6182, 106, 136, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[45623, 1010, 165, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[45813, 1016, 1493, 37, 92, "Input"],
Cell[47309, 1055, 1511, 30, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48857, 1090, 1161, 27, 72, "Input"],
Cell[50021, 1119, 1493, 30, 52, "Output"],
Cell[51517, 1151, 647, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52201, 1165, 844, 21, 52, "Input"],
Cell[53048, 1188, 1155, 25, 52, "Output"]
}, Open  ]],
Cell[54218, 1216, 1888, 46, 112, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
