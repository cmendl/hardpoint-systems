(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     64314,       1399]
NotebookOptionsPosition[     61597,       1301]
NotebookOutlinePosition[     61941,       1316]
CellTagsIndexPosition[     61898,       1313]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Anharmonic Chains", "Title",
 CellChangeTimes->{{3.59677987870557*^9, 3.596779889516188*^9}, {
  3.5967804634790173`*^9, 3.5967804758017216`*^9}, {3.5973486710445538`*^9, 
  3.5973486731016717`*^9}, {3.5973488033071194`*^9, 3.5973488074423556`*^9}}],

Cell["\<\
Reference: H. Spohn, Nonlinear fluctuating hydrodynamics for anharmonic \
chains. J. Stat. Phys. 154, 1191-1227 (2014)\
\>", "Text",
 CellChangeTimes->{{3.5966309106922355`*^9, 3.5966309448751907`*^9}, {
  3.61539048177046*^9, 3.61539050974306*^9}}],

Cell["Shoulder potential", "Text",
 CellChangeTimes->{{3.597348682436206*^9, 3.59734868566039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetDirectory", "[", 
   RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}]], "Input",
 CellChangeTimes->{{3.597344823479486*^9, 3.5973448344961157`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"<<", "\"\<anharm_chains_shoulder.m\>\""}], ";"}]], "Input",
 CellChangeTimes->{{3.5973460118404565`*^9, 3.597346033514696*^9}, {
  3.5976487301792974`*^9, 3.597648731720386*^9}, {3.613211672719891*^9, 
  3.6132116735509386`*^9}}],

Cell[CellGroupData[{

Cell["Import initial data", "Section",
 CellChangeTimes->{{3.5973487644628973`*^9, 3.5973487774776416`*^9}, {
  3.5973497655211544`*^9, 3.597349771645505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"load", " ", "position", " ", "data", " ", "from", " ", "disk"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["r", 
    RowBox[{"data", ",", "0"}]], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<current_test_field_r0.dat\>\"", ",", "\"\<Real64\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5967815245657077`*^9, 3.5967815326961727`*^9}, {
   3.5967819770045853`*^9, 3.596782018703971*^9}, {3.5967821407389507`*^9, 
   3.5967821866975794`*^9}, {3.5967983494767103`*^9, 3.596798352068858*^9}, 
   3.597346466734475*^9, 3.5973469093667917`*^9, 3.6132116941021137`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6952100911496908`", ",", "1.498932635079024`", ",", 
   "1.7791027592692439`", ",", "1.449950374849227`", ",", 
   "1.4651531614016031`", ",", "0.6717850204030649`", ",", 
   "1.2899889215460059`", ",", "0.5675412921515937`", ",", 
   "1.8118609695973342`", ",", "1.5732903439496821`", ",", 
   "1.978231300145773`", ",", "1.1921514604968968`", ",", 
   "1.313276567908856`", ",", "1.0563438360060384`", ",", 
   "1.4558775043422822`", ",", "1.8005240292357976`"}], "}"}]], "Output",
 CellChangeTimes->{{3.596782153443678*^9, 3.596782159479023*^9}, 
   3.596782658083541*^9, 3.5967858210064497`*^9, 3.596786040736018*^9, 
   3.59678725289835*^9, {3.596798352518884*^9, 3.596798362296444*^9}, 
   3.5969129739279313`*^9, 3.5973460470834723`*^9, 3.5973464800892386`*^9, 
   3.5973466069114923`*^9, 3.5973469357012978`*^9, 3.5973488377810907`*^9, 
   3.597349938233033*^9, 3.597648737022689*^9, 3.6132127331415434`*^9, 
   3.613214394675578*^9, 3.613215301373438*^9, {3.6132153866143136`*^9, 
   3.613215411972764*^9}, {3.61321561943163*^9, 3.613215658191847*^9}, 
   3.6132156923438005`*^9, 3.6132157332861423`*^9, 3.613588724626616*^9, 
   3.6135890874853706`*^9, 3.613764471891684*^9, 3.6149492554535475`*^9, 
   3.619085009605764*^9, 3.619085329422056*^9, 3.6277338030212026`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"length", " ", "L"}], ",", " ", 
    RowBox[{"should", " ", "be", " ", "conserved"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Total", "[", 
   SubscriptBox["r", 
    RowBox[{"data", ",", "0"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967834993776608`*^9, 3.5967835166946507`*^9}, 
   3.5973469449668283`*^9}],

Cell[BoxData["21.599220267532118`"], "Output",
 CellChangeTimes->{{3.596783502721852*^9, 3.5967835176437054`*^9}, 
   3.596785823577597*^9, 3.596786041341052*^9, 3.596787253024357*^9, 
   3.59679836293548*^9, 3.596912975046995*^9, 3.5973460483835464`*^9, 
   3.597346481881341*^9, 3.5973466080795593`*^9, {3.597346937634409*^9, 
   3.5973469462679024`*^9}, 3.5973488387851486`*^9, 3.5973499382570343`*^9, 
   3.5976487370416903`*^9, 3.6132127345026217`*^9, 3.6132143946865788`*^9, 
   3.613215301385439*^9, {3.6132153866283145`*^9, 3.6132154119857645`*^9}, {
   3.6132156194446306`*^9, 3.613215658203848*^9}, 3.613215692356801*^9, 
   3.6132157333011427`*^9, 3.613588724639617*^9, 3.613589087498371*^9, 
   3.6137644719036846`*^9, 3.614949256607613*^9, 3.6190850096177645`*^9, 
   3.619085329435057*^9, 3.627733804058262*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  SubscriptBox["q", 
   RowBox[{"data", ",", "0"}]], "=", 
  RowBox[{"Most", "[", 
   RowBox[{"Accumulate", "[", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], ",", "0"}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.5967893805180426`*^9, 3.5967893899555826`*^9}, {
  3.5967895292355485`*^9, 3.596789530870642*^9}, {3.596789585013739*^9, 
  3.5967895863698163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0", ",", "0.6952100911496908`", ",", "2.1941427262287148`", ",", 
   "3.9732454854979586`", ",", "5.423195860347185`", ",", 
   "6.888349021748788`", ",", "7.560134042151853`", ",", "8.85012296369786`", 
   ",", "9.417664255849454`", ",", "11.229525225446789`", ",", 
   "12.802815569396472`", ",", "14.781046869542244`", ",", 
   "15.973198330039141`", ",", "17.286474897947997`", ",", 
   "18.342818733954037`", ",", "19.79869623829632`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5967893857503414`*^9, 3.596789393010757*^9}, 
   3.596789531457676*^9, 3.596789586848844*^9, 3.59679836363052*^9, 
   3.596912975866042*^9, 3.5973460496216173`*^9, 3.597346484030464*^9, 
   3.5973466090126123`*^9, 3.597346948273017*^9, 3.5973488410632787`*^9, 
   3.597349938281036*^9, 3.5976487370626917`*^9, 3.6132127357976956`*^9, 
   3.6132143946985793`*^9, 3.6132153013964396`*^9, {3.6132153866473155`*^9, 
   3.6132154120067663`*^9}, {3.6132156194566317`*^9, 3.6132156582168484`*^9}, 
   3.613215692370802*^9, 3.6132157333151436`*^9, 3.6135887246516175`*^9, 
   3.613589087511372*^9, 3.613764471915685*^9, 3.61494925776668*^9, 
   3.6190850096307654`*^9, 3.619085329448058*^9, 3.627733805108322*^9}],

Cell[BoxData["16"], "Output",
 CellChangeTimes->{{3.5967893857503414`*^9, 3.596789393010757*^9}, 
   3.596789531457676*^9, 3.596789586848844*^9, 3.59679836363052*^9, 
   3.596912975866042*^9, 3.5973460496216173`*^9, 3.597346484030464*^9, 
   3.5973466090126123`*^9, 3.597346948273017*^9, 3.5973488410632787`*^9, 
   3.597349938281036*^9, 3.5976487370626917`*^9, 3.6132127357976956`*^9, 
   3.6132143946985793`*^9, 3.6132153013964396`*^9, {3.6132153866473155`*^9, 
   3.6132154120067663`*^9}, {3.6132156194566317`*^9, 3.6132156582168484`*^9}, 
   3.613215692370802*^9, 3.6132157333151436`*^9, 3.6135887246516175`*^9, 
   3.613589087511372*^9, 3.613764471915685*^9, 3.61494925776668*^9, 
   3.6190850096307654`*^9, 3.619085329448058*^9, 3.627733805110322*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"load", " ", "momentum", " ", "data", " ", "from", " ", "disk"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["p", 
    RowBox[{"data", ",", "0"}]], "=", 
   RowBox[{"Import", "[", 
    RowBox[{"\"\<current_test_field_p0.dat\>\"", ",", "\"\<Real64\>\""}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.596782172919791*^9, 3.596782194764041*^9}, {
   3.5967988456820917`*^9, 3.5967988462061214`*^9}, {3.597346489663786*^9, 
   3.5973464910828676`*^9}, 3.5973469569285126`*^9, 3.6132116946761465`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.5103617026983827`", ",", "0.2654165553173022`", ",", 
   RowBox[{"-", "0.11027518575444438`"}], ",", "1.305796141969587`", ",", 
   RowBox[{"-", "0.3306924923476049`"}], ",", "0.3476296788309191`", ",", 
   RowBox[{"-", "0.6045296199913266`"}], ",", 
   RowBox[{"-", "0.31087494578789204`"}], ",", "0.20489633166438748`", ",", 
   "0.16902616465612985`", ",", "0.056226305830089085`", ",", 
   "0.780130559458416`", ",", "0.5957745788302355`", ",", 
   "0.20321110680866836`", ",", "0.22330218102490768`", ",", 
   "0.6706207266617707`"}], "}"}]], "Output",
 CellChangeTimes->{{3.5967821769490223`*^9, 3.5967821985022545`*^9}, 
   3.5967826635918565`*^9, 3.5967835203648605`*^9, 3.596785824379643*^9, 
   3.596786041906085*^9, 3.5967872531663647`*^9, 3.5967895373590136`*^9, 
   3.5967895880929155`*^9, 3.59679884670815*^9, 3.596912977732149*^9, 
   3.596915581727089*^9, 3.597346054007868*^9, 3.597346492245934*^9, 
   3.5973466124148073`*^9, 3.5973469574985447`*^9, 3.5973488425693645`*^9, 
   3.59734993835404*^9, 3.5976487371166945`*^9, 3.6132127386688595`*^9, 
   3.613214394732581*^9, 3.6132153014314413`*^9, {3.6132153866833177`*^9, 
   3.613215412042768*^9}, {3.6132156194936333`*^9, 3.6132156582538505`*^9}, 
   3.613215692404804*^9, 3.613215733349146*^9, 3.6135887246846194`*^9, 
   3.6135890875463743`*^9, 3.613764471958688*^9, 3.61494926092286*^9, 
   3.619085009668768*^9, 3.6190853294840603`*^9, 3.627733807410454*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"expectation", " ", "value", " ", "is", " ", "zero"}], ",", " ", 
    RowBox[{
    "but", " ", "not", " ", "current", " ", "actual", " ", "value"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Mean", "[", 
   SubscriptBox["p", 
    RowBox[{"data", ",", "0"}]], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967896123303013`*^9, 3.596789630357332*^9}, {
  3.597346974940542*^9, 3.5973469754545717`*^9}, {3.597347328353757*^9, 
  3.5973473532011776`*^9}}],

Cell[BoxData["0.2485012368668455`"], "Output",
 CellChangeTimes->{{3.596789613634376*^9, 3.5967896308063583`*^9}, 
   3.5969129787592077`*^9, 3.596915582375126*^9, 3.5973460551139317`*^9, 
   3.5973464936750154`*^9, {3.5973469603927107`*^9, 3.5973469759456*^9}, 
   3.5973473546122584`*^9, 3.5973488437254305`*^9, 3.5973499383760414`*^9, 
   3.5976487371356955`*^9, 3.613212739911931*^9, 3.613214394743582*^9, 
   3.6132153014494424`*^9, {3.613215386697318*^9, 3.613215412057769*^9}, {
   3.6132156195106344`*^9, 3.6132156582718515`*^9}, 3.613215692422805*^9, 
   3.6132157333631463`*^9, 3.61358872469862*^9, 3.6135890875613747`*^9, 
   3.613764471976689*^9, 3.614949261932918*^9, 3.6190850096817684`*^9, 
   3.619085329497061*^9, 3.627733808514517*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   SubscriptBox["V", "pot"], "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1", "/", "2"}], ",", "1", ",", "1"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.596782481000413*^9, 3.59678250944304*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"VisualizeField", "[", 
  RowBox[{
   RowBox[{"Accumulate", "[", 
    RowBox[{"Prepend", "[", 
     RowBox[{
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], ",", "0.4"}], "]"}], "]"}], ",", 
   SubscriptBox["V", "pot"], ",", "20"}], "]"}]], "Input",
 CellChangeTimes->{{3.5967825151643667`*^9, 3.5967825436219945`*^9}, {
  3.596783115201687*^9, 3.596783131740633*^9}, {3.5973488494877605`*^9, 
  3.5973488694549026`*^9}}],

Cell[BoxData[
 GraphicsBox[{{PointBox[{0.4, 0}], PointBox[{1.0952100911496907`, 0}], 
    PointBox[{2.5941427262287147`, 0}], PointBox[{4.373245485497959, 0}], 
    PointBox[{5.823195860347186, 0}], PointBox[{7.288349021748789, 0}], 
    PointBox[{7.960134042151854, 0}], PointBox[{9.250122963697859, 0}], 
    PointBox[{9.817664255849452, 0}], PointBox[{11.629525225446788`, 0}], 
    PointBox[{13.20281556939647, 0}], PointBox[{15.181046869542243`, 0}], 
    PointBox[{16.37319833003914, 0}], PointBox[{17.686474897947996`, 0}], 
    PointBox[{18.742818733954035`, 0}], PointBox[{20.198696238296318`, 0}], 
    PointBox[{21.999220267532117`, 0}]}, 
   {RGBColor[1, 0, 0], CircleBox[{0.4, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{1.0952100911496907`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{2.5941427262287147`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{4.373245485497959, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{5.823195860347186, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{7.288349021748789, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{7.960134042151854, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{9.250122963697859, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{9.817664255849452, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{11.629525225446788`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{13.20281556939647, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{15.181046869542243`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{16.37319833003914, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{17.686474897947996`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{18.742818733954035`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{20.198696238296318`, 0}, NCache[Rational[1, 4], 0.25]], 
    CircleBox[{21.999220267532117`, 0}, NCache[Rational[1, 4], 0.25]]}, 
   {RGBColor[1, 0.5, 0], CircleBox[{0.4, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{1.0952100911496907`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{2.5941427262287147`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{4.373245485497959, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{5.823195860347186, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{7.288349021748789, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{7.960134042151854, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{9.250122963697859, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{9.817664255849452, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{11.629525225446788`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{13.20281556939647, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{15.181046869542243`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{16.37319833003914, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{17.686474897947996`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{18.742818733954035`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{20.198696238296318`, 0}, NCache[Rational[1, 2], 0.5]], 
    CircleBox[{21.999220267532117`, 0}, NCache[Rational[1, 2], 0.5]]}, 
   {GrayLevel[0.5], LineBox[{{0, 0}, {20, 0}}]}},
  ImageSize->Large,
  PlotRange->{{-1, 22}, All}]], "Output",
 CellChangeTimes->{3.6190853445089197`*^9, 3.62773381014161*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"without", " ", "collision", " ", "detection"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"Animate", "[", 
   RowBox[{
    RowBox[{"VisualizeField", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], "+", "0.4", "+", 
       RowBox[{"t", " ", 
        SubscriptBox["p", 
         RowBox[{"data", ",", "0"}]]}]}], ",", 
      SubscriptBox["V", "pot"], ",", "20"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", 
    RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967822229996557`*^9, 3.5967822286809807`*^9}, {
  3.596782266410139*^9, 3.5967823531551003`*^9}, {3.596782464601475*^9, 
  3.596782473984011*^9}, {3.59678270771338*^9, 3.5967828467173305`*^9}, {
  3.596782881907343*^9, 3.5967829128851147`*^9}, {3.596782996939923*^9, 
  3.5967830590674763`*^9}, {3.5967831682717223`*^9, 3.5967831897649517`*^9}, {
  3.596783373252446*^9, 3.596783390922457*^9}, {3.5967835297073956`*^9, 
  3.5967835331135902`*^9}, {3.5967894412025137`*^9, 3.596789484443987*^9}, {
  3.5967895442364063`*^9, 3.5967895944082766`*^9}, {3.5973488762202897`*^9, 
  3.597348876508306*^9}, {3.627733826644554*^9, 3.627733829111695*^9}}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 2.494140625, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 10}}, Typeset`size$$ = {576., {12., 15.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$1507$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$1507$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> $CellContext`VisualizeField[
       Subscript[$CellContext`q, $CellContext`data, 0] + 
        0.4 + $CellContext`t$$ 
         Subscript[$CellContext`p, $CellContext`data, 0], 
        Subscript[$CellContext`V, $CellContext`pot], 20], 
      "Specifications" :> {{$CellContext`t$$, 0, 10, AnimationRunning -> 
         False, AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {49., 56.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.5967833800148335`*^9, 3.596783402302108*^9}, 
   3.5967835334846115`*^9, 3.596783579122222*^9, 3.5967837091226573`*^9, 
   3.596787253242369*^9, {3.5967894713442373`*^9, 3.5967894852250314`*^9}, 
   3.596789547298582*^9, 3.596789595385332*^9, {3.596794658426922*^9, 
   3.5967946727097387`*^9}, 3.597346062505354*^9, {3.5973488731831155`*^9, 
   3.5973488775083632`*^9}, 3.597349938454046*^9, 3.5976487372026997`*^9, 
   3.6132127467093196`*^9, 3.6132143947875843`*^9, 3.6132153015034456`*^9, {
   3.6132153867653227`*^9, 3.613215412110772*^9}, {3.613215619559637*^9, 
   3.6132156583188543`*^9}, 3.6132156924698076`*^9, 3.6132157334331503`*^9, 
   3.6135887247386227`*^9, 3.613589087609378*^9, 3.6137644720256915`*^9, 
   3.619085009727771*^9, 3.619085329591066*^9, {3.627733813197785*^9, 
   3.6277338306257815`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run simulation", "Section",
 CellChangeTimes->{{3.5973487644628973`*^9, 3.5973487673450623`*^9}, {
  3.5973497829601517`*^9, 3.597349785121276*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NextCollision", "[", 
   RowBox[{
    SubscriptBox["r", 
     RowBox[{"data", ",", "0"}]], ",", 
    SubscriptBox["p", 
     RowBox[{"data", ",", "0"}]], ",", 
    SubscriptBox["V", "pot"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5967854220366306`*^9, 3.5967854638080196`*^9}, {
  3.5967855063464527`*^9, 3.5967855065524645`*^9}, {3.5967855530041213`*^9, 
  3.5967855623036532`*^9}, {3.596787026235385*^9, 3.596787044739444*^9}, {
  3.596787892574937*^9, 3.596787896550164*^9}, {3.5969147075420885`*^9, 
  3.5969147101372366`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], ",", "0.9521592988222457`", ",", 
   "0.18041626082479148`", ",", "Core", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.596785510285678*^9, {3.596785548471862*^9, 3.5967855729632626`*^9}, {
   3.596785626428321*^9, 3.596785636924921*^9}, {3.596785675940153*^9, 
   3.596785692393094*^9}, {3.5967857430479913`*^9, 3.5967857645912232`*^9}, {
   3.5967858071266565`*^9, 3.5967858311710315`*^9}, {3.5967860156775846`*^9, 
   3.5967860487894783`*^9}, 3.5967860849965496`*^9, 3.596786130482151*^9, 
   3.596787045442484*^9, 3.596787253322374*^9, 3.5967878974222145`*^9, 
   3.5967896751108923`*^9, 3.596913913574676*^9, 3.596914314069583*^9, 
   3.596914710700269*^9, 3.596915636131201*^9, 3.596915843358053*^9, 
   3.597346069620761*^9, 3.5973465044486322`*^9, 3.597348911602313*^9, 
   3.597349938577053*^9, 3.597648737241702*^9, 3.613212754827784*^9, 
   3.613214394815586*^9, 3.613215301532447*^9, {3.613215386779323*^9, 
   3.613215412140774*^9}, {3.613215619589639*^9, 3.613215658348856*^9}, 
   3.6132156924998093`*^9, 3.613215733447151*^9, 3.613588724765624*^9, 
   3.613589087637379*^9, 3.613764472056693*^9, 3.6149492683532853`*^9, 
   3.6190850097557726`*^9, 3.619085329621068*^9, 3.627733840003318*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CollisionInfo", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      SubscriptBox["q", 
       RowBox[{"data", ",", "0"}]], ",", 
      SubscriptBox["p", 
       RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
    RowBox[{"Total", "[", 
     SubscriptBox["r", 
      RowBox[{"data", ",", "0"}]], "]"}], ",", 
    SubscriptBox["V", "pot"]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.5969164681147876`*^9, 3.596916474195135*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.18041626082479148`", ",", "Core", ",", "6", ",", 
   RowBox[{"{", 
    RowBox[{"0.9521592988222456`", ",", 
     RowBox[{"-", "0.12230483392138487`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.596916482018583*^9, 3.5973460707248244`*^9, 3.597346505765707*^9, 
   3.597348915830555*^9, 3.597349938601054*^9, 3.5976487372637033`*^9, 
   3.6132127564938793`*^9, 3.6132143948285866`*^9, 3.613215301547448*^9, {
   3.613215386793324*^9, 3.6132154121537743`*^9}, {3.61321561960364*^9, 
   3.613215658363857*^9}, 3.61321569251381*^9, 3.6132157334621525`*^9, 
   3.613588724777625*^9, 3.61358908765138*^9, 3.613764472068694*^9, 
   3.6149492707694235`*^9, 3.619085009768773*^9, 3.619085329641069*^9, 
   3.627733841217387*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"UpdateField", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
     RowBox[{"Total", "[", 
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], "]"}], ",", 
     SubscriptBox["V", "pot"]}], "]"}], "\[IndentingNewLine]", 
   RowBox[{"Differences", "[", 
    RowBox[{"First", "[", "%", "]"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.5967883007112813`*^9, 3.5967883196773663`*^9}, {
   3.596788399616938*^9, 3.5967884279695597`*^9}, {3.59678893814074*^9, 
   3.596788944115082*^9}, {3.5967892892898245`*^9, 3.596789294847142*^9}, 
   3.596789368987383*^9, {3.5967896997032986`*^9, 3.5967897028944817`*^9}, {
   3.5967924655864983`*^9, 3.5967924693947163`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0.09207755006901609`", ",", "0.7430955536210349`", ",", 
     "2.1742472895531386`", ",", "4.20883234283155`", ",", "5.363533557395`", 
     ",", "6.951067068555186`", ",", "7.451067068555186`", ",", 
     "8.794036068394698`", ",", "9.45463088586506`", ",", 
     "11.260020294055604`", ",", "12.812959709254327`", ",", 
     "14.921795108034884`", ",", "16.080685751846158`", ",", 
     "17.323137485996483`", ",", "18.38310607848857`", ",", 
     "19.91968712223224`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5103617026983827`", ",", "0.2654165553173022`", ",", 
     RowBox[{"-", "0.11027518575444438`"}], ",", "1.305796141969587`", ",", 
     RowBox[{"-", "0.3306924923476049`"}], ",", 
     RowBox[{"-", "0.6045296199913266`"}], ",", "0.3476296788309191`", ",", 
     RowBox[{"-", "0.31087494578789204`"}], ",", "0.20489633166438748`", ",", 
     "0.16902616465612985`", ",", "0.056226305830089085`", ",", 
     "0.780130559458416`", ",", "0.5957745788302355`", ",", 
     "0.20321110680866836`", ",", "0.22330218102490768`", ",", 
     "0.6706207266617707`"}], "}"}], ",", "0.18041626082479148`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.596788428437587*^9, 3.5967884386511707`*^9}, 
   3.5967887181091547`*^9, 3.5967887607175922`*^9, {3.5967888267623696`*^9, 
   3.59678885387292*^9}, {3.596788940639883*^9, 3.596788944450101*^9}, 
   3.596789295642188*^9, {3.5967896813752503`*^9, 3.5967897036445246`*^9}, 
   3.596789895630505*^9, 3.596789954313862*^9, 3.5967923972675905`*^9, {
   3.5967924592361355`*^9, 3.596792469662731*^9}, 3.596913918066933*^9, 
   3.5969143158816867`*^9, 3.5969156772695537`*^9, 3.596915845010148*^9, 
   3.5973460744000344`*^9, 3.597346509620928*^9, 3.597348919180747*^9, 
   3.5973499386250553`*^9, 3.5976487372827044`*^9, 3.6132127621662035`*^9, 
   3.6132143948415875`*^9, 3.6132153015604486`*^9, {3.613215386807325*^9, 
   3.613215412167775*^9}, {3.6132156196176405`*^9, 3.6132156583778577`*^9}, 
   3.6132156925268106`*^9, 3.613215733476153*^9, 3.6135887247906256`*^9, 
   3.6135890876653805`*^9, 3.6137644720836945`*^9, 3.614949273525581*^9, 
   3.619085009782774*^9, 3.61908532966107*^9, 3.6277338424174557`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.6510180035520188`", ",", "1.4311517359321038`", ",", 
   "2.0345850532784113`", ",", "1.1547012145634499`", ",", 
   "1.5875335111601858`", ",", "0.5`", ",", "1.3429689998395125`", ",", 
   "0.6605948174703613`", ",", "1.8053894081905444`", ",", 
   "1.5529394151987237`", ",", "2.108835398780556`", ",", 
   "1.158890643811274`", ",", "1.2424517341503254`", ",", 
   "1.059968592492087`", ",", "1.53658104374367`"}], "}"}]], "Output",
 CellChangeTimes->{{3.596788428437587*^9, 3.5967884386511707`*^9}, 
   3.5967887181091547`*^9, 3.5967887607175922`*^9, {3.5967888267623696`*^9, 
   3.59678885387292*^9}, {3.596788940639883*^9, 3.596788944450101*^9}, 
   3.596789295642188*^9, {3.5967896813752503`*^9, 3.5967897036445246`*^9}, 
   3.596789895630505*^9, 3.596789954313862*^9, 3.5967923972675905`*^9, {
   3.5967924592361355`*^9, 3.596792469662731*^9}, 3.596913918066933*^9, 
   3.5969143158816867`*^9, 3.5969156772695537`*^9, 3.596915845010148*^9, 
   3.5973460744000344`*^9, 3.597346509620928*^9, 3.597348919180747*^9, 
   3.5973499386250553`*^9, 3.5976487372827044`*^9, 3.6132127621662035`*^9, 
   3.6132143948415875`*^9, 3.6132153015604486`*^9, {3.613215386807325*^9, 
   3.613215412167775*^9}, {3.6132156196176405`*^9, 3.6132156583778577`*^9}, 
   3.6132156925268106`*^9, 3.613215733476153*^9, 3.6135887247906256`*^9, 
   3.6135890876653805`*^9, 3.6137644720836945`*^9, 3.614949273525581*^9, 
   3.619085009782774*^9, 3.61908532966107*^9, 3.627733842419456*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["f", "seq"], "=", 
   RowBox[{"FieldSequence", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["q", 
        RowBox[{"data", ",", "0"}]], ",", 
       SubscriptBox["p", 
        RowBox[{"data", ",", "0"}]], ",", "0"}], "}"}], ",", 
     RowBox[{"Total", "[", 
      SubscriptBox["r", 
       RowBox[{"data", ",", "0"}]], "]"}], ",", 
     SubscriptBox["V", "pot"], ",", "32"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Length", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.5973490830671206`*^9, 3.5973491350730953`*^9}, {
   3.597349573947197*^9, 3.597349577512401*^9}, 3.597349651063608*^9}],

Cell[BoxData["33"], "Output",
 CellChangeTimes->{
  3.5973495776744103`*^9, 3.59734965145163*^9, 3.597349938668058*^9, 
   3.5976487373187065`*^9, 3.613212764750352*^9, 3.6132143948645887`*^9, 
   3.6132153015884504`*^9, {3.6132153868383265`*^9, 3.613215412196777*^9}, {
   3.613215619647642*^9, 3.6132156584108596`*^9}, 3.6132156925578127`*^9, 
   3.6132157335071545`*^9, 3.613588724812627*^9, 3.613589087688382*^9, 
   3.6137644721076965`*^9, 3.6149492758887157`*^9, 3.6190850098067756`*^9, 
   3.619085329694072*^9, 3.627733844915599*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["f", "seq"], "\[LeftDoubleBracket]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.5967932520064793`*^9, 3.59679326076398*^9}, {
   3.5969139536539683`*^9, 3.5969139590232754`*^9}, 3.596914004326867*^9, {
   3.59734610998407*^9, 3.59734611506536*^9}, {3.597348931457449*^9, 
   3.5973489316374593`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0.6952100911496908`", ",", "2.1941427262287148`", ",", 
       "3.9732454854979586`", ",", "5.423195860347185`", ",", 
       "6.888349021748788`", ",", "7.560134042151853`", ",", 
       "8.85012296369786`", ",", "9.417664255849454`", ",", 
       "11.229525225446789`", ",", "12.802815569396472`", ",", 
       "14.781046869542244`", ",", "15.973198330039141`", ",", 
       "17.286474897947997`", ",", "18.342818733954037`", ",", 
       "19.79869623829632`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5103617026983827`", ",", "0.2654165553173022`", ",", 
       RowBox[{"-", "0.11027518575444438`"}], ",", "1.305796141969587`", ",", 
       RowBox[{"-", "0.3306924923476049`"}], ",", "0.3476296788309191`", ",", 
       RowBox[{"-", "0.6045296199913266`"}], ",", 
       RowBox[{"-", "0.31087494578789204`"}], ",", "0.20489633166438748`", 
       ",", "0.16902616465612985`", ",", "0.056226305830089085`", ",", 
       "0.780130559458416`", ",", "0.5957745788302355`", ",", 
       "0.20321110680866836`", ",", "0.22330218102490768`", ",", 
       "0.6706207266617707`"}], "}"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.09207755006901626`", ",", "0.743095553621035`", ",", 
       "2.174247289553138`", ",", "4.208832342831551`", ",", 
       "5.363533557394999`", ",", "6.951067068555186`", ",", 
       "7.451067068555186`", ",", "8.794036068394698`", ",", 
       "9.45463088586506`", ",", "11.260020294055604`", ",", 
       "12.812959709254327`", ",", "14.921795108034885`", ",", 
       "16.080685751846158`", ",", "17.323137485996487`", ",", 
       "18.38310607848857`", ",", "19.91968712223224`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0.5103617026983827`", ",", "0.2654165553173022`", ",", 
       RowBox[{"-", "0.11027518575444438`"}], ",", "1.305796141969587`", ",", 
       RowBox[{"-", "0.3306924923476049`"}], ",", 
       RowBox[{"-", "0.6045296199913266`"}], ",", "0.3476296788309191`", ",", 
       RowBox[{"-", "0.31087494578789204`"}], ",", "0.20489633166438748`", 
       ",", "0.16902616465612985`", ",", "0.056226305830089085`", ",", 
       "0.780130559458416`", ",", "0.5957745788302355`", ",", 
       "0.20321110680866836`", ",", "0.22330218102490768`", ",", 
       "0.6706207266617707`"}], "}"}], ",", "0.18041626082479179`"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0.8911048818739966`", ",", "1.4279913408946316`", ",", 
       "2.510196075785697`", ",", "3.550974245242938`", ",", 
       "4.550974245242938`", ",", "5.909043553738327`", ",", 
       "7.895472598954528`", ",", "9.696184903205927`", ",", 
       "10.958049226940782`", ",", "12.2889728692932`", ",", 
       "14.166266341371731`", ",", "15.847514839979073`", ",", 
       "16.959327568855354`", ",", "18.618055938561586`", ",", 
       "19.934887822080892`", ",", "20.988907273821322`"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"-", "0.6045296199913266`"}], ",", "0.26541655531730224`", ",", 
       RowBox[{"-", "0.3306924923476049`"}], ",", 
       RowBox[{"-", "1.0344317734279314`"}], ",", "0.6706207266617707`", ",", 
       "0.5103617026983827`", ",", 
       RowBox[{"-", "0.3861418700341117`"}], ",", "0.16902616465612974`", ",",
        "0.05622630583008914`", ",", "1.0711865064709587`", ",", 
       "1.8968343436680861`", ",", "0.20321110680866838`", ",", 
       "0.22330218102490762`", ",", "0.5957745788302355`", ",", 
       "0.780130559458416`", ",", 
       RowBox[{"-", "0.1102751857544444`"}]}], "}"}], ",", 
     "2.7608724288841433`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.596793252284495*^9, 3.5967932611950045`*^9}, 
   3.5967947041505365`*^9, 3.5969139262253995`*^9, 3.596913959711315*^9, 
   3.596914004511877*^9, 3.5969143237441363`*^9, 3.59691585449269*^9, 
   3.5969171371330533`*^9, 3.597346081194423*^9, 3.5973461157103972`*^9, 
   3.5973465143071957`*^9, {3.597348927821241*^9, 3.597348932148488*^9}, {
   3.5973491127588186`*^9, 3.5973491370912104`*^9}, 3.5973496551788435`*^9, 
   3.597349938691059*^9, 3.5976487373377075`*^9, 3.613212767181491*^9, 
   3.6132143948785896`*^9, 3.613215301601451*^9, {3.613215386851327*^9, 
   3.613215412212778*^9}, {3.6132156196626434`*^9, 3.6132156584258604`*^9}, 
   3.6132156925728135`*^9, 3.6132157335211554`*^9, 3.6135887248266277`*^9, 
   3.6135890877003827`*^9, 3.613764472120697*^9, 3.614949278738879*^9, 
   3.6190850098197765`*^9, 3.6190853297080727`*^9, 3.6277338458396516`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Interpolation", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Last", "[", "#", "]"}], ",", 
       RowBox[{"First", "[", "#", "]"}]}], "}"}], "&"}], "/@", 
    SubscriptBox["f", "seq"]}], ",", 
   RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Animate", "[", 
  RowBox[{
   RowBox[{"VisualizeField", "[", 
    RowBox[{
     RowBox[{"%", "[", "t", "]"}], ",", 
     SubscriptBox["V", "pot"], ",", "20"}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", "1.9"}], "}"}], ",", 
   RowBox[{"AnimationRunning", "\[Rule]", "False"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.5967902258253913`*^9, 3.596790243615409*^9}, {
   3.5967929736985607`*^9, 3.596793015417947*^9}, {3.5967931032839727`*^9, 
   3.5967931211919966`*^9}, {3.596793152111765*^9, 3.596793174019018*^9}, {
   3.5967932161084256`*^9, 3.5967932227328043`*^9}, 3.59679327387673*^9, {
   3.596800106512207*^9, 3.5968001117875085`*^9}, 3.5973462614357324`*^9, {
   3.597348939956935*^9, 3.5973489544927664`*^9}, {3.597349145074667*^9, 
   3.5973491451756725`*^9}}],

Cell[BoxData[
 TagBox[
  TemplateBox[{RowBox[{
      StyleBox[
       TagBox["InterpolatingFunction", "SummaryHead"], 
       "NonInterpretableSummary"], 
      StyleBox["[", "NonInterpretableSummary"], 
      DynamicModuleBox[{Typeset`open$$ = False}, 
       PanelBox[
        PaneSelectorBox[{False -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquarePlusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = True), Appearance -> None,
                 Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "2.7608724288841433`"}], "}"}], "}"}],
                     "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output dimensions: \"", "SummaryItemAnnotation"],
                    "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "16", "}"}], "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}], True -> GridBox[{{
              PaneBox[
               ButtonBox[
                DynamicBox[
                 FEPrivate`FrontEndResource[
                 "FEBitmaps", "SquareMinusIconMedium"]], 
                ButtonFunction :> (Typeset`open$$ = False), Appearance -> 
                None, Evaluator -> Automatic, Method -> "Preemptive"], 
               Alignment -> {Center, Center}, ImageSize -> 
               Dynamic[{
                 Automatic, 3.5 CurrentValue["FontCapHeight"]/
                  AbsoluteCurrentValue[Magnification]}]], 
              GraphicsBox[{{
                 GrayLevel[0.6], 
                 AbsolutePointSize[5], 
                 PointBox[{1, 1}], 
                 PointBox[{2, 4}], 
                 PointBox[{3, 2}], 
                 PointBox[{4, 3}]}, {{}, {}, {
                  AbsoluteThickness[1], 
                  Opacity[1.], 
                  LineBox[CompressedData["
1:eJwBMQPO/CFib1JlAgAAADIAAAACAAAA4ScLwZmZ6T/ACPskWpOYv4AjHgZ5
3Os/cnpQh5xu1j/qWn1XCVDuP5K7ih5ptuc/r+pongFN8D/CUK87BHLxP46d
cUQ/bPE/ujUa8/qu9j9TbqBw1aPyP/TWyyAhFfw/neDJZqDG8z+QAqdF9GsA
QM1wGePDAfU/VsVD/9nXAkCidscSKDf2P6Bp73exDQVA/B1wDMFX9z+TpM3k
wfUGQDzjPoyykPg/7M3Z+O7ZCEABSgjW2LT5P3pl9LwNcgpAbCYw0z/T+j86
ypori9cLQL0gflb/Cfw/lpOs9xIqDUCTvMaj8yv9Pw4alcoYNg5AT3Y1d0Bm
/j+pB2LLtyIPQLClAv7Nmv8/NnA5bbjSD0BLO2UnSF0AQFrcILXmpw9AsTLc
klX5AED+sDHBQukOQNp6UGP9igFAbZ+lR/sLDkD10dd20SgCQNHi3Mj38wxA
42MO5MXDAkAZdr6AZb8LQJRGQrZUVANArv7zEMKHCkA4OInLD/EDQLBlMO3M
IglAnnrNRWWDBEA3d8OX6skHQNf3wBnbEgVAD3D3ndNyBkADhMcwfa4FQHOK
7Wak/wRA8WDLrLk/BkC/MhCgYawDQNJM4msi3QZAwss/TmVLAkCGc6iEq3cH
QIsIg92+BgFA/OprAs8HCECrPCvgePD/P2VxQsMepAhAKXVLE0Xg/j+RSBbp
CDYJQPRz0a7WJ/4/kFqZaBPFCUDN4sX5uLj9P4J7LytKYApAvh1MbRmT/T82
7cJSG/EKQHzT1YZwwv0/3W1pvRiOC0B2LZ/10lT+P0c/DY2wIAxAVrX8MJA7
/z+DS2C2aLAMQElWzbMzPQBAsmbGIk1MDUCi9bAadCABQKTSKfTL3Q1AYexd
q+EpAkCJTaAId3sOQFyS/ndEhgNAQAPGdkIWD0BHWcLdahwFQLoJ6Umopg9A
vd1CiejSBkCTjw8wnSEQQPiVkXD08QhAq0KpbbNqEEBsk2Azxi4LQCyTGthZ
shBAYCBYjj+gDUAnaxVkFgARQMwfdA9ySBBAg+uOIqBIEUBj/5rHgMsRQNFn
q5SZmRFAL++xNeOlE0Dwt3AR
                   "]]}}}, AspectRatio -> 1, Axes -> False, Background -> 
               GrayLevel[0.93], Frame -> True, FrameStyle -> Directive[
                 GrayLevel[0.7], 
                 Thickness[Tiny]], FrameTicks -> None, 
               ImageSize -> {Automatic, 
                 Dynamic[
                 3.5 (CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
                   Magnification])]}, PlotRange -> {{0, 5}, {0, 5}}], 
              GridBox[{{
                 RowBox[{
                   TagBox["\"Domain: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", 
                    RowBox[{"{", 
                    RowBox[{"0.`", ",", "2.7608724288841433`"}], "}"}], "}"}],
                     "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Output dimensions: \"", "SummaryItemAnnotation"],
                    "\[InvisibleSpace]", 
                   TagBox[
                    RowBox[{"{", "16", "}"}], "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Order: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["1", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Method: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["\"Hermite\"", "SummaryItem"]}]}, {
                 RowBox[{
                   TagBox["\"Periodic: \"", "SummaryItemAnnotation"], 
                   "\[InvisibleSpace]", 
                   TagBox["False", "SummaryItem"]}]}}, 
               GridBoxAlignment -> {
                "Columns" -> {{Left}}, "Rows" -> {{Automatic}}}, AutoDelete -> 
               False, GridBoxItemSize -> {
                "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
               GridBoxSpacings -> {
                "Columns" -> {{2}}, "Rows" -> {{Automatic}}}, 
               BaseStyle -> {
                ShowStringCharacters -> False, NumberMarks -> False, 
                 PrintPrecision -> 3, ShowSyntaxStyles -> False}]}}, 
            GridBoxAlignment -> {"Rows" -> {{Top}}}, AutoDelete -> False, 
            GridBoxItemSize -> {
             "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
            BaselinePosition -> {1, 1}]}, 
         Dynamic[Typeset`open$$], ImageSize -> Automatic], BaselinePosition -> 
        Baseline], DynamicModuleValues :> {}], 
      StyleBox["]", "NonInterpretableSummary"]}]},
   "CopyTag",
   DisplayFunction->(#& ),
   InterpretationFunction->("InterpolatingFunction[{{0., 2.76087}}, <>]"& )],
  False,
  Editable->False,
  SelectWithContents->True,
  Selectable->False]], "Output",
 CellChangeTimes->{
  3.596790244582464*^9, 3.59679038997478*^9, 3.5967924125354643`*^9, 
   3.5967926629387865`*^9, {3.5967929967938814`*^9, 3.5967930157159643`*^9}, 
   3.596793122870093*^9, {3.5967931534238405`*^9, 3.5967931745640497`*^9}, {
   3.5967932191466*^9, 3.5967932232438335`*^9}, 3.596793275240808*^9, 
   3.596794705362606*^9, 3.596913931897724*^9, 3.597346084540614*^9, 
   3.597346262605799*^9, {3.59734894091899*^9, 3.5973489548517866`*^9}, 
   3.5973491463787413`*^9, 3.5973496653954277`*^9, 3.5973499387150607`*^9, 
   3.5976487373587084`*^9, 3.6132127710097094`*^9, 3.6132143948925905`*^9, 
   3.613215301615452*^9, {3.613215386864328*^9, 3.6132154122257786`*^9}, {
   3.613215619675644*^9, 3.613215658438861*^9}, 3.6132156925858145`*^9, 
   3.6132157335351562`*^9, 3.613588724846629*^9, 3.6135890877143836`*^9, 
   3.6137644721426983`*^9, 3.6149492817810535`*^9, 3.6190850098337774`*^9, 
   3.6190853297210736`*^9, 3.627733849095838*^9}],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`t$$ = 0.3960914802551269, Typeset`show$$ = 
    True, Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{
      Hold[$CellContext`t$$], 0, 1.9}}, Typeset`size$$ = {576., {12., 15.}}, 
    Typeset`update$$ = 0, Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`t$1635$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, "Variables" :> {$CellContext`t$$ = 0}, 
      "ControllerVariables" :> {
        Hold[$CellContext`t$$, $CellContext`t$1635$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> $CellContext`VisualizeField[
        InterpolatingFunction[{{0., 2.7608724288841433`}}, {
         4, 3, 0, {33}, {2}, 0, 0, 0, 0, Automatic, {}, {}, False}, {{0., 
         0.18041626082479179`, 0.2749486708393565, 0.5689545617278507, 
         0.7012463157967657, 0.7969543109420618, 0.7980278101158941, 
         0.8516744615689252, 0.8760807528405692, 0.9550569462149868, 
         0.9923430731854361, 1.0088779346918035`, 1.042284930720205, 
         1.118436140589592, 1.3120347163572237`, 1.3280372724077003`, 
         1.4605424259636959`, 1.7662086523681557`, 1.8046704549127448`, 
         1.910036406677986, 1.9140409518085069`, 2.1037963653378364`, 
         2.1044496112101876`, 2.28664915016805, 2.2963081603105984`, 
         2.325974521005674, 2.4348264990600286`, 2.457363943420507, 
         2.52908137459171, 2.635499476754574, 2.7184715768917203`, 
         2.720147739862676, 2.7608724288841433`}}, CompressedData["
1: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

         "], {Automatic}][$CellContext`t$$], 
        Subscript[$CellContext`V, $CellContext`pot], 20], 
      "Specifications" :> {{$CellContext`t$$, 0, 1.9, AnimationRunning -> 
         False, AppearanceElements -> {
          "ProgressSlider", "PlayPauseButton", "FasterSlowerButtons", 
           "DirectionButton"}}}, 
      "Options" :> {
       ControlType -> Animator, AppearanceElements -> None, DefaultBaseStyle -> 
        "Animate", DefaultLabelStyle -> "AnimateLabel", SynchronousUpdating -> 
        True, ShrinkingDelay -> 10.}, "DefaultOptions" :> {}],
     ImageSizeCache->{627., {49., 56.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Animate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.596790244582464*^9, 3.59679038997478*^9, 3.5967924125354643`*^9, 
   3.5967926629387865`*^9, {3.5967929967938814`*^9, 3.5967930157159643`*^9}, 
   3.596793122870093*^9, {3.5967931534238405`*^9, 3.5967931745640497`*^9}, {
   3.5967932191466*^9, 3.5967932232438335`*^9}, 3.596793275240808*^9, 
   3.596794705362606*^9, 3.596913931897724*^9, 3.597346084540614*^9, 
   3.597346262605799*^9, {3.59734894091899*^9, 3.5973489548517866`*^9}, 
   3.5973491463787413`*^9, 3.5973496653954277`*^9, 3.5973499387150607`*^9, 
   3.5976487373587084`*^9, 3.6132127710097094`*^9, 3.6132143948925905`*^9, 
   3.613215301615452*^9, {3.613215386864328*^9, 3.6132154122257786`*^9}, {
   3.613215619675644*^9, 3.613215658438861*^9}, 3.6132156925858145`*^9, 
   3.6132157335351562`*^9, 3.613588724846629*^9, 3.6135890877143836`*^9, 
   3.6137644721426983`*^9, 3.6149492817810535`*^9, 3.6190850098337774`*^9, 
   3.6190853297210736`*^9, 3.6277338491428404`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Save currents to disk for comparison with C implementation", "Section",
 CellChangeTimes->{{3.5973492095113525`*^9, 3.597349212176505*^9}, {
  3.597349243104274*^9, 3.597349246965495*^9}, {3.613214220365608*^9, 
  3.613214242937899*^9}, {3.6132144440454016`*^9, 3.6132144496277213`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"reference", " ", "collisions"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox["coll", "ref"], "=", 
     RowBox[{
      RowBox[{
       RowBox[{"CollisionInfo", "[", 
        RowBox[{
         RowBox[{"AdvanceField", "[", 
          RowBox[{"#", ",", "0.0001"}], "]"}], ",", 
         RowBox[{"Total", "[", 
          SubscriptBox["r", 
           RowBox[{"data", ",", "0"}]], "]"}], ",", 
         SubscriptBox["V", "pot"]}], "]"}], "&"}], "/@", 
      SubscriptBox["f", "seq"]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Length", "[", "%", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.59764415023734*^9, 3.597644249868039*^9}, {
  3.5976444252400694`*^9, 3.597644425564088*^9}, {3.5976487904367447`*^9, 
  3.597648798004177*^9}, {3.613214197876322*^9, 3.6132141996244216`*^9}}],

Cell[BoxData["33"], "Output",
 CellChangeTimes->{
  3.5976441001764765`*^9, 3.5976441531755085`*^9, 3.5976442290408473`*^9, 
   3.597644439462883*^9, 3.5976469047918916`*^9, {3.597648785849482*^9, 
   3.597648798366198*^9}, 3.6132138710756297`*^9, 3.6132142599988747`*^9, 
   3.6132143949355927`*^9, 3.6132153016714554`*^9, {3.613215386922331*^9, 
   3.6132154122867823`*^9}, {3.6132156197346478`*^9, 3.6132156584968643`*^9}, 
   3.613215692643818*^9, 3.6132157335851593`*^9, 3.613588724888631*^9, 
   3.613589087771387*^9, 3.613764472184701*^9, 3.6149492914606066`*^9, 
   3.6190850098767796`*^9, 3.619085329938086*^9, 3.627733860889512*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", "example", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   SubscriptBox["coll", "ref"], "\[LeftDoubleBracket]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", 
     RowBox[{"-", "1"}]}], "}"}], "\[RightDoubleBracket]"}]}]], "Input",
 CellChangeTimes->{{3.613214264874154*^9, 3.613214278152913*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.18041626082479179`", ",", "Core", ",", "6", ",", 
     RowBox[{"{", 
      RowBox[{"0.9521592988222456`", ",", 
       RowBox[{"-", "0.12230483392138487`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.2749486708393565`", ",", "PlatBounce", ",", "4", ",", 
     RowBox[{"{", 
      RowBox[{"1.6364886343171918`", ",", "0.7978730199437934`"}], "}"}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2.818817424358379`", ",", "PlatBounce", ",", "3", ",", 
     RowBox[{"{", 
      RowBox[{"0.7037392810803265`", ",", 
       RowBox[{"-", "0.4803457846910922`"}]}], "}"}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.613213874381819*^9, {3.6132142688593817`*^9, 3.6132142783009214`*^9}, 
   3.613214394952594*^9, 3.613214459713298*^9, 3.613215301684456*^9, {
   3.6132153869363317`*^9, 3.613215412300783*^9}, {3.613215619748648*^9, 
   3.6132156585098653`*^9}, 3.6132156926568184`*^9, 3.61321573359916*^9, 
   3.6135887453037987`*^9, 3.6135890877833877`*^9, 3.613764472198702*^9, 
   3.614949292726679*^9, 3.61908500988878*^9, 3.619085329954087*^9, 
   3.6277338624606023`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "time", " ", "slots", " ", "for", " ", "grouping", " ", "collision", " ", 
    "events", " ", "and", " ", "corresponding", " ", "currents"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    SubscriptBox["t", "slot"], "=", 
    RowBox[{"2", "/", "5"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.6132139277908735`*^9, 3.613213981013918*^9}, {
  3.6132142499893026`*^9, 3.6132142510233617`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  SubscriptBox["J", "list"], "=", 
  RowBox[{"Table", "[", 
   RowBox[{
    RowBox[{
     FractionBox["1", 
      RowBox[{"Length", "[", 
       SubscriptBox["r", 
        RowBox[{"data", ",", "0"}]], "]"}]], 
     RowBox[{
      RowBox[{"Total", "[", 
       RowBox[{"Last", "/@", 
        RowBox[{"Select", "[", 
         RowBox[{
          SubscriptBox["coll", "ref"], ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"i", "-", "1"}], ")"}], 
               SubscriptBox["t", "slot"]}], "\[LessEqual]", 
              RowBox[{"First", "[", "#", "]"}]}], "\[And]", 
             RowBox[{
              RowBox[{"First", "[", "#", "]"}], "<", 
              RowBox[{"i", " ", 
               SubscriptBox["t", "slot"]}]}]}], ")"}], "&"}]}], "]"}]}], 
       "]"}], "/", 
      SubscriptBox["t", "slot"]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "5"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6132139869772587`*^9, 3.6132140557291913`*^9}, {
  3.6132140953304567`*^9, 3.6132141497585697`*^9}, {3.613214302153286*^9, 
  3.613214312786894*^9}, {3.613588843215399*^9, 3.613588844232457*^9}, {
  3.6190851787044363`*^9, 3.6190852310654306`*^9}, {3.6190852681545525`*^9, 
  3.6190852819633417`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0.40447623955303713`", ",", "0.10555752906600133`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.5009904696847457`", ",", "0.1459004983762417`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7634454138852715`", ",", "0.4004542610626528`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.34377318422140396`", ",", "0.21468754116701794`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0.7120422921299596`", ",", "0.538921420015911`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6132140234103427`*^9, 3.613214056202218*^9}, {
   3.6132141299354353`*^9, 3.613214150271599*^9}, {3.6132143073065805`*^9, 
   3.6132143131219134`*^9}, 3.613214394969595*^9, 3.613214469447855*^9, 
   3.6132153017004566`*^9, {3.613215386952333*^9, 3.6132154123187838`*^9}, {
   3.6132156197646494`*^9, 3.613215658525866*^9}, 3.6132156926738195`*^9, 
   3.6132157336171613`*^9, 3.6135887537412815`*^9, 3.6135888446934834`*^9, 
   3.613589087797388*^9, 3.613764472215702*^9, 3.6149492964438915`*^9, 
   3.6190850099057813`*^9, 3.6190852383378468`*^9, 3.6190852834754286`*^9, 
   3.619085329972088*^9, 3.6277338658117943`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"save", " ", "to", " ", "disk", " ", "for", " ", "comparison"}], 
   " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Export", "[", 
    RowBox[{"\"\<current_test_Jref.dat\>\"", ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Prepend", "[", 
         RowBox[{"#", ",", 
          RowBox[{"(*", 
           RowBox[{"ignore", " ", 
            SubscriptBox["r", "j"], " ", "current"}], "*)"}], "0"}], "]"}], 
        "&"}], "/@", 
       SubscriptBox["J", "list"]}], "]"}], ",", "\"\<Real64\>\""}], "]"}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6132143401814613`*^9, 3.6132143793847036`*^9}, {
  3.613214425850361*^9, 3.6132144363439612`*^9}, {3.6190852544247665`*^9, 
  3.619085274969942*^9}}]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1067, 677},
WindowMargins->{{Automatic, 260}, {150, Automatic}},
FrontEndVersion->"10.0 for Microsoft Windows (64-bit) (July 1, 2014)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 255, 3, 90, "Title"],
Cell[838, 27, 259, 5, 30, "Text"],
Cell[1100, 34, 99, 1, 30, "Text"],
Cell[1202, 37, 191, 4, 31, "Input"],
Cell[1396, 43, 264, 5, 31, "Input"],
Cell[CellGroupData[{
Cell[1685, 52, 159, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[1869, 58, 660, 14, 52, "Input"],
Cell[2532, 74, 1326, 21, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3895, 100, 394, 11, 52, "Input"],
Cell[4292, 113, 825, 11, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5154, 129, 524, 14, 52, "Input"],
Cell[5681, 145, 1231, 19, 52, "Output"],
Cell[6915, 166, 757, 10, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7709, 181, 582, 13, 52, "Input"],
Cell[8294, 196, 1474, 22, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[9805, 223, 529, 13, 52, "Input"],
Cell[10337, 238, 753, 10, 31, "Output"]
}, Open  ]],
Cell[11105, 251, 242, 7, 31, "Input"],
Cell[CellGroupData[{
Cell[11372, 262, 457, 11, 31, "Input"],
Cell[11832, 275, 3236, 47, 42, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[15105, 327, 1305, 27, 52, "Input"],
Cell[16413, 356, 2863, 53, 122, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19325, 415, 154, 2, 63, "Section"],
Cell[CellGroupData[{
Cell[19504, 421, 638, 14, 52, "Input"],
Cell[20145, 437, 1282, 20, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21464, 462, 540, 15, 52, "Input"],
Cell[22007, 479, 772, 14, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22816, 498, 945, 22, 72, "Input"],
Cell[23764, 522, 2240, 37, 92, "Output"],
Cell[26007, 561, 1510, 23, 52, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[27554, 589, 686, 19, 52, "Input"],
Cell[28243, 610, 541, 8, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[28821, 623, 523, 11, 52, "Input"],
Cell[29347, 636, 4643, 84, 192, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34027, 725, 1153, 27, 52, "Input"],
Cell[35183, 754, 9893, 195, 81, "Output"],
Cell[45079, 951, 9160, 154, 122, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[54288, 1111, 293, 3, 63, "Section"],
Cell[CellGroupData[{
Cell[54606, 1118, 888, 23, 72, "Input"],
Cell[55497, 1143, 642, 9, 31, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56176, 1157, 349, 8, 52, "Input"],
Cell[56528, 1167, 1172, 26, 52, "Output"]
}, Open  ]],
Cell[57715, 1196, 474, 12, 52, "Input"],
Cell[CellGroupData[{
Cell[58214, 1212, 1357, 37, 50, "Input"],
Cell[59574, 1251, 1178, 22, 31, "Output"]
}, Open  ]],
Cell[60767, 1276, 802, 21, 52, "Input"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
